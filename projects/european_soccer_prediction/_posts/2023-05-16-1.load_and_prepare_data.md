---
layout: single
title: "1. Load and prepare data"
permalink: /projects/european_soccer_prediction/1.load_and_prepare_data/
comments: false
author_profile: true
read_time: true
toc: true
toc_label: "Table of Contents"
toc_sticky: true
categories: ["european_soccer_prediction"]
---

```python
import numpy as np 
import pandas as pd 

import sqlite3 as sql 
import xml.etree.ElementTree as ET
```


```python
import warnings
warnings.filterwarnings('ignore')
```


```python
pd.set_option('display.max_columns', None)
```

- The european soccer database consists of the data related to the soccer matches of 10 european soccer leagues from 2008/2009 season to 2015/2016 season.


```python
con = sql.connect("../data/database.sqlite")
```


```python
sql_master_tables = pd.read_sql('select * from sqlite_master where type="table";',con)
sql_master_tables
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>name</th>
      <th>tbl_name</th>
      <th>rootpage</th>
      <th>sql</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>table</td>
      <td>sqlite_sequence</td>
      <td>sqlite_sequence</td>
      <td>4</td>
      <td>CREATE TABLE sqlite_sequence(name,seq)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>table</td>
      <td>Player_Attributes</td>
      <td>Player_Attributes</td>
      <td>11</td>
      <td>CREATE TABLE "Player_Attributes" (\n\t`id`\tIN...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>table</td>
      <td>Player</td>
      <td>Player</td>
      <td>14</td>
      <td>CREATE TABLE `Player` (\n\t`id`\tINTEGER PRIMA...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>table</td>
      <td>Match</td>
      <td>Match</td>
      <td>18</td>
      <td>CREATE TABLE `Match` (\n\t`id`\tINTEGER PRIMAR...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>table</td>
      <td>League</td>
      <td>League</td>
      <td>24</td>
      <td>CREATE TABLE `League` (\n\t`id`\tINTEGER PRIMA...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>table</td>
      <td>Country</td>
      <td>Country</td>
      <td>26</td>
      <td>CREATE TABLE `Country` (\n\t`id`\tINTEGER PRIM...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>table</td>
      <td>Team</td>
      <td>Team</td>
      <td>29</td>
      <td>CREATE TABLE "Team" (\n\t`id`\tINTEGER PRIMARY...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>table</td>
      <td>Team_Attributes</td>
      <td>Team_Attributes</td>
      <td>2</td>
      <td>CREATE TABLE `Team_Attributes` (\n\t`id`\tINTE...</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_sql(
    "select * from sqlite_sequence", con
    )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Team</td>
      <td>103916</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Country</td>
      <td>51958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>League</td>
      <td>51958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Match</td>
      <td>51958</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Player</td>
      <td>11075</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Player_Attributes</td>
      <td>183978</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Team_Attributes</td>
      <td>1458</td>
    </tr>
  </tbody>
</table>
</div>



- There are 7 tables.
    - Player related tables
        - Player table
        - Player_Attributes table
    - Team related tables
        - Country table
        - League table
        - Team table
        - Team_Attributes table
    - Match related tables
        - Match table

# 1. Player related tables: Player, Player_Attributes

## 1.1. Player


```python
org_player = pd.read_sql(
    "select * from Player", con
    )

org_player.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_api_id</th>
      <th>player_name</th>
      <th>player_fifa_api_id</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>218353</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>155782</td>
      <td>Aaron Cresswell</td>
      <td>189615</td>
      <td>1989-12-15 00:00:00</td>
      <td>170.18</td>
      <td>146</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>162549</td>
      <td>Aaron Doran</td>
      <td>186170</td>
      <td>1991-05-13 00:00:00</td>
      <td>170.18</td>
      <td>163</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>30572</td>
      <td>Aaron Galindo</td>
      <td>140161</td>
      <td>1982-05-08 00:00:00</td>
      <td>182.88</td>
      <td>198</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>23780</td>
      <td>Aaron Hughes</td>
      <td>17725</td>
      <td>1979-11-08 00:00:00</td>
      <td>182.88</td>
      <td>154</td>
    </tr>
  </tbody>
</table>
</div>




```python
org_player.shape
```




    (11060, 7)




```python
len(org_player.player_api_id.unique())
```




    11060




```python
len(org_player.player_fifa_api_id.unique())
```




    11060




```python
sum(org_player.groupby(["player_api_id"]).nunique().player_fifa_api_id != 1)
```




    0



- There are total 11,060 soccer players and their birthday, height, and weight information.
- Each player has exactly one player_api_id, one player_fifa_api_id, and one (player_api_id, player_fifa_api_id) set. So, we can use any player id to identify a player.

## 1.2. Player_Attributes


```python
org_player_attr = pd.read_sql(
    "select * from Player_Attributes", con
    )

org_player_attr.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_fifa_api_id</th>
      <th>player_api_id</th>
      <th>date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>218353</td>
      <td>505942</td>
      <td>2016-02-18 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-11-19 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-09-21 00:00:00</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>218353</td>
      <td>505942</td>
      <td>2015-03-20 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>218353</td>
      <td>505942</td>
      <td>2007-02-22 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
org_player_attr.shape
```




    (183978, 42)



- There are total 38 player attributes.
- player_fifa_api_id or player_api_id can be used to merge the Player and Player_Attribute tables.


```python
len(org_player_attr.player_fifa_api_id.unique())
```




    11062




```python
len(org_player_attr.player_api_id.unique())
```




    11060



- There are different number of unique player_api_id and player_fifa_api_id.
- It means that some player_api_id have different player_fifa_api_id.


```python
target_bool = org_player_attr.groupby(["player_api_id"]).nunique().player_fifa_api_id != 1
target_player_api = org_player_attr.groupby(["player_api_id"]).nunique().player_fifa_api_id[target_bool].index
org_player_attr[org_player_attr.player_api_id.isin(target_player_api)].sort_values(["player_api_id", "date"]).head(15)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>player_fifa_api_id</th>
      <th>player_api_id</th>
      <th>date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>104862</th>
      <td>104863</td>
      <td>202486</td>
      <td>11285</td>
      <td>2007-02-22 00:00:00</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>56.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>57.0</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>41.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104881</th>
      <td>104882</td>
      <td>208618</td>
      <td>11285</td>
      <td>2007-02-22 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>104861</th>
      <td>104862</td>
      <td>202486</td>
      <td>11285</td>
      <td>2011-02-22 00:00:00</td>
      <td>68.0</td>
      <td>77.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>41.0</td>
      <td>26.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>38.0</td>
      <td>49.0</td>
      <td>33.0</td>
      <td>51.0</td>
      <td>59.0</td>
      <td>52.0</td>
      <td>59.0</td>
      <td>66.0</td>
      <td>52.0</td>
      <td>63.0</td>
      <td>76.0</td>
      <td>68.0</td>
      <td>75.0</td>
      <td>64.0</td>
      <td>81.0</td>
      <td>53.0</td>
      <td>71.0</td>
      <td>68.0</td>
      <td>31.0</td>
      <td>49.0</td>
      <td>47.0</td>
      <td>70.0</td>
      <td>63.0</td>
      <td>64.0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>104860</th>
      <td>104861</td>
      <td>202486</td>
      <td>11285</td>
      <td>2011-08-30 00:00:00</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>41.0</td>
      <td>26.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>38.0</td>
      <td>49.0</td>
      <td>33.0</td>
      <td>51.0</td>
      <td>59.0</td>
      <td>51.0</td>
      <td>54.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>58.0</td>
      <td>41.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>50.0</td>
      <td>73.0</td>
      <td>53.0</td>
      <td>71.0</td>
      <td>65.0</td>
      <td>31.0</td>
      <td>49.0</td>
      <td>47.0</td>
      <td>69.0</td>
      <td>63.0</td>
      <td>64.0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>104859</th>
      <td>104860</td>
      <td>202486</td>
      <td>11285</td>
      <td>2012-02-22 00:00:00</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>41.0</td>
      <td>26.0</td>
      <td>74.0</td>
      <td>63.0</td>
      <td>38.0</td>
      <td>49.0</td>
      <td>33.0</td>
      <td>51.0</td>
      <td>59.0</td>
      <td>61.0</td>
      <td>54.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>58.0</td>
      <td>41.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>51.0</td>
      <td>75.0</td>
      <td>53.0</td>
      <td>71.0</td>
      <td>65.0</td>
      <td>31.0</td>
      <td>49.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>64.0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>104880</th>
      <td>104881</td>
      <td>208618</td>
      <td>11285</td>
      <td>2012-08-31 00:00:00</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>56.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>57.0</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>41.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104879</th>
      <td>104880</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-03-21 00:00:00</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>62.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>56.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>57.0</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>41.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104878</th>
      <td>104879</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-04-11 00:00:00</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>47.0</td>
      <td>57.0</td>
      <td>35.0</td>
      <td>64.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>49.0</td>
      <td>58.0</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>45.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104877</th>
      <td>104878</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-04-25 00:00:00</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>63.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>35.0</td>
      <td>65.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>49.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>64.0</td>
      <td>52.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>51.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104858</th>
      <td>104859</td>
      <td>202486</td>
      <td>11285</td>
      <td>2014-09-18 00:00:00</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>63.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>64.0</td>
      <td>35.0</td>
      <td>65.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>49.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>51.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104876</th>
      <td>104877</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-09-18 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>104875</th>
      <td>104876</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-11-14 00:00:00</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>63.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>64.0</td>
      <td>35.0</td>
      <td>65.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>49.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>51.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104874</th>
      <td>104875</td>
      <td>208618</td>
      <td>11285</td>
      <td>2014-11-28 00:00:00</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>63.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>64.0</td>
      <td>35.0</td>
      <td>65.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>49.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>74.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>71.0</td>
      <td>51.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104873</th>
      <td>104874</td>
      <td>208618</td>
      <td>11285</td>
      <td>2015-02-13 00:00:00</td>
      <td>70.0</td>
      <td>77.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>70.0</td>
      <td>56.0</td>
      <td>68.0</td>
      <td>62.0</td>
      <td>69.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>74.0</td>
      <td>77.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>104872</th>
      <td>104873</td>
      <td>208618</td>
      <td>11285</td>
      <td>2015-02-20 00:00:00</td>
      <td>70.0</td>
      <td>77.0</td>
      <td>right</td>
      <td>high</td>
      <td>medium</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>47.0</td>
      <td>72.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>56.0</td>
      <td>68.0</td>
      <td>62.0</td>
      <td>69.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>74.0</td>
      <td>77.0</td>
      <td>71.0</td>
      <td>54.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>56.0</td>
      <td>53.0</td>
      <td>22.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>55.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>



- For example, player_api_id 11285 have two player_fifa_api_id 208618 and 202486.
- So it is better to use the player_api_id when merge tables.
- There are 11060 players' attributes based on the number of unique player_api_id.

## 1.3. Merge all player related tables.

- Let's make one player table by merging the Player and Player_Attributes table.
- We drop the id and player_fifa_api_id columns because we will only use player_api_id to identify a player later.


```python
df_player = org_player_attr.drop(["id", "player_fifa_api_id"], axis = 1) \
                           .merge(org_player.drop(["id", "player_fifa_api_id"], axis = 1), 
                                  how = "left", on = "player_api_id") 
               
df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
      <th>player_name</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>2016-02-18 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>2015-11-19 00:00:00</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>2015-09-21 00:00:00</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>2015-03-20 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>2007-02-22 00:00:00</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29 00:00:00</td>
      <td>182.88</td>
      <td>187</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183973</th>
      <td>39902</td>
      <td>2009-08-30 00:00:00</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>59.0</td>
      <td>89.0</td>
      <td>77.0</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>78.0</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>81.0</td>
      <td>56.0</td>
      <td>78.0</td>
      <td>86.0</td>
      <td>88.0</td>
      <td>83.0</td>
      <td>22.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05 00:00:00</td>
      <td>180.34</td>
      <td>176</td>
    </tr>
    <tr>
      <th>183974</th>
      <td>39902</td>
      <td>2009-02-22 00:00:00</td>
      <td>78.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>76.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05 00:00:00</td>
      <td>180.34</td>
      <td>176</td>
    </tr>
    <tr>
      <th>183975</th>
      <td>39902</td>
      <td>2008-08-30 00:00:00</td>
      <td>77.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05 00:00:00</td>
      <td>180.34</td>
      <td>176</td>
    </tr>
    <tr>
      <th>183976</th>
      <td>39902</td>
      <td>2007-08-30 00:00:00</td>
      <td>78.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>57.0</td>
      <td>86.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>61.0</td>
      <td>60.0</td>
      <td>77.0</td>
      <td>69.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05 00:00:00</td>
      <td>180.34</td>
      <td>176</td>
    </tr>
    <tr>
      <th>183977</th>
      <td>39902</td>
      <td>2007-02-22 00:00:00</td>
      <td>80.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>68.0</td>
      <td>57.0</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>53.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>38.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05 00:00:00</td>
      <td>180.34</td>
      <td>176</td>
    </tr>
  </tbody>
</table>
<p>183978 rows × 44 columns</p>
</div>




```python
df_player.dtypes
```




    player_api_id            int64
    date                    object
    overall_rating         float64
    potential              float64
    preferred_foot          object
    attacking_work_rate     object
    defensive_work_rate     object
    crossing               float64
    finishing              float64
    heading_accuracy       float64
    short_passing          float64
    volleys                float64
    dribbling              float64
    curve                  float64
    free_kick_accuracy     float64
    long_passing           float64
    ball_control           float64
    acceleration           float64
    sprint_speed           float64
    agility                float64
    reactions              float64
    balance                float64
    shot_power             float64
    jumping                float64
    stamina                float64
    strength               float64
    long_shots             float64
    aggression             float64
    interceptions          float64
    positioning            float64
    vision                 float64
    penalties              float64
    marking                float64
    standing_tackle        float64
    sliding_tackle         float64
    gk_diving              float64
    gk_handling            float64
    gk_kicking             float64
    gk_positioning         float64
    gk_reflexes            float64
    player_name             object
    birthday                object
    height                 float64
    weight                   int64
    dtype: object



- birthday and date columns need to be changed to the datetime type.
- Since there are other date columns that have different meanings in other tables, let's change the column name date in this table to the player_measured_date.


```python
df_player["player_measured_date"] = pd.to_datetime(df_player.date)
df_player["birthday"] = pd.to_datetime(df_player.birthday)
```


```python
# just change the columns order
df_player = df_player[["player_api_id", "player_name", "birthday", "height", "weight", "player_measured_date", 
                       'overall_rating', 'potential', 'preferred_foot', 'attacking_work_rate', 'defensive_work_rate', 
                       'crossing', 'finishing', 'heading_accuracy', 'short_passing', 'volleys', 
                       'dribbling', 'curve', 'free_kick_accuracy', 'long_passing', 'ball_control', 
                       'acceleration', 'sprint_speed', 'agility', 'reactions', 'balance', 
                       'shot_power', 'jumping', 'stamina', 'strength', 'long_shots', 
                       'aggression', 'interceptions', 'positioning', 'vision', 'penalties', 
                       'marking', 'standing_tackle', 'sliding_tackle', 'gk_diving', 'gk_handling', 
                       'gk_kicking', 'gk_positioning', 'gk_reflexes']]

df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_name</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
      <th>player_measured_date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2016-02-18</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-11-19</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-09-21</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-03-20</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2007-02-22</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183973</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2009-08-30</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>59.0</td>
      <td>89.0</td>
      <td>77.0</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>78.0</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>81.0</td>
      <td>56.0</td>
      <td>78.0</td>
      <td>86.0</td>
      <td>88.0</td>
      <td>83.0</td>
      <td>22.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183974</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2009-02-22</td>
      <td>78.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>76.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183975</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2008-08-30</td>
      <td>77.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183976</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2007-08-30</td>
      <td>78.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>57.0</td>
      <td>86.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>61.0</td>
      <td>60.0</td>
      <td>77.0</td>
      <td>69.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183977</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2007-02-22</td>
      <td>80.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>68.0</td>
      <td>57.0</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>53.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>38.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>7.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
<p>183978 rows × 44 columns</p>
</div>




```python
df_player.to_csv("../data/df_player.csv", index = False)
```

## <font color="magenta">1.4. Summary</font>

![df_player_summary](/assets/images/projects/european_soccer_prediction/df_player_summary.png)

# 2. Match table


```python
org_match = pd.read_sql(
    "select * from Match", con
    )

org_match.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>home_player_Y8</th>
      <th>home_player_Y9</th>
      <th>home_player_Y10</th>
      <th>home_player_Y11</th>
      <th>away_player_Y1</th>
      <th>away_player_Y2</th>
      <th>away_player_Y3</th>
      <th>away_player_Y4</th>
      <th>away_player_Y5</th>
      <th>away_player_Y6</th>
      <th>away_player_Y7</th>
      <th>away_player_Y8</th>
      <th>away_player_Y9</th>
      <th>away_player_Y10</th>
      <th>away_player_Y11</th>
      <th>home_player_1</th>
      <th>home_player_2</th>
      <th>home_player_3</th>
      <th>home_player_4</th>
      <th>home_player_5</th>
      <th>home_player_6</th>
      <th>home_player_7</th>
      <th>home_player_8</th>
      <th>home_player_9</th>
      <th>home_player_10</th>
      <th>home_player_11</th>
      <th>away_player_1</th>
      <th>away_player_2</th>
      <th>away_player_3</th>
      <th>away_player_4</th>
      <th>away_player_5</th>
      <th>away_player_6</th>
      <th>away_player_7</th>
      <th>away_player_8</th>
      <th>away_player_9</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
      <th>goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492473</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.35</td>
      <td>4.20</td>
      <td>1.85</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.80</td>
      <td>3.3</td>
      <td>3.75</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.70</td>
      <td>3.30</td>
      <td>4.33</td>
      <td>1.90</td>
      <td>3.3</td>
      <td>4.00</td>
      <td>1.65</td>
      <td>3.40</td>
      <td>4.50</td>
      <td>1.78</td>
      <td>3.25</td>
      <td>4.00</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492474</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.95</td>
      <td>3.20</td>
      <td>3.60</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.95</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.83</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>1.95</td>
      <td>3.3</td>
      <td>3.80</td>
      <td>2.00</td>
      <td>3.25</td>
      <td>3.25</td>
      <td>1.85</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492475</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.38</td>
      <td>3.30</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.30</td>
      <td>2.55</td>
      <td>2.60</td>
      <td>3.1</td>
      <td>2.3</td>
      <td>2.50</td>
      <td>3.2</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>3.25</td>
      <td>2.40</td>
      <td>2.63</td>
      <td>3.3</td>
      <td>2.50</td>
      <td>2.35</td>
      <td>3.25</td>
      <td>2.65</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.50</td>
      <td>2.30</td>
      <td>3.20</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492476</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>7.50</td>
      <td>1.40</td>
      <td>4.00</td>
      <td>6.80</td>
      <td>1.40</td>
      <td>3.9</td>
      <td>6.0</td>
      <td>1.44</td>
      <td>3.6</td>
      <td>6.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.00</td>
      <td>1.44</td>
      <td>4.0</td>
      <td>7.50</td>
      <td>1.45</td>
      <td>3.75</td>
      <td>6.50</td>
      <td>1.50</td>
      <td>3.75</td>
      <td>5.50</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492477</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.60</td>
      <td>4.00</td>
      <td>3.3</td>
      <td>1.7</td>
      <td>4.00</td>
      <td>3.4</td>
      <td>1.72</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>3.40</td>
      <td>1.70</td>
      <td>4.50</td>
      <td>3.5</td>
      <td>1.73</td>
      <td>4.50</td>
      <td>3.40</td>
      <td>1.65</td>
      <td>4.50</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>4.75</td>
      <td>3.30</td>
      <td>1.67</td>
    </tr>
  </tbody>
</table>
</div>




```python
org_match.shape
```




    (25979, 115)




```python
len(org_match.match_api_id.unique())
```




    25979



- There are total 25,979 matches and 115 match information variables.
- Since there are 25,979 number of unique match_api_id, let's use the match_api_id to identify a match.

- Match information variables can be categorized in 4 categories
    - basic match information
        - country id, league id
        - home team id, away team id
        - season, stage, date
    - player information
        - home team players, away team players
    - betting information
    - in-game information
        - goal, shoton, shotoff
        - foulcommit, card
        - cross, corner
        - possession
        - home_team_goal, away_team_goal

- Let's divide the match table into 4 different tables to make analysis easier later.

## 2.1. Basic match information


```python
basic_match_information_col = ["match_api_id", "country_id", "league_id", "home_team_api_id", "away_team_api_id", "season", "stage", "date", "home_team_goal", "away_team_goal"]

```


```python
df_match_basic = org_match[basic_match_information_col]
df_match_basic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>1</td>
      <td>1</td>
      <td>9987</td>
      <td>9993</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>1</td>
      <td>1</td>
      <td>10000</td>
      <td>9994</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>1</td>
      <td>1</td>
      <td>9984</td>
      <td>8635</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>1</td>
      <td>1</td>
      <td>9991</td>
      <td>9998</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>1</td>
      <td>1</td>
      <td>7947</td>
      <td>9985</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>24558</td>
      <td>24558</td>
      <td>10190</td>
      <td>10191</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22 00:00:00</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>24558</td>
      <td>24558</td>
      <td>9824</td>
      <td>10199</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23 00:00:00</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>24558</td>
      <td>24558</td>
      <td>9956</td>
      <td>10179</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23 00:00:00</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>24558</td>
      <td>24558</td>
      <td>7896</td>
      <td>10243</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22 00:00:00</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>24558</td>
      <td>24558</td>
      <td>10192</td>
      <td>9931</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23 00:00:00</td>
      <td>4</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 10 columns</p>
</div>




```python
df_match_basic.dtypes
```




    match_api_id         int64
    country_id           int64
    league_id            int64
    home_team_api_id     int64
    away_team_api_id     int64
    season              object
    stage                int64
    date                object
    home_team_goal       int64
    away_team_goal       int64
    dtype: object



- The date column need to be converted to the datetime dtype.
- Since there are other date columns that have different meanings in other tables, let's change the column name date in this table to the match_date.


```python
df_match_basic["match_date"] = pd.to_datetime(df_match_basic.date)
```


```python
# Just change the columns order
df_match_basic = df_match_basic[["match_api_id", "country_id", "league_id", "season", "stage", 
                                 "match_date", "home_team_api_id", "away_team_api_id", "home_team_goal", "away_team_goal"]]
df_match_basic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>match_date</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>10190</td>
      <td>10191</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9824</td>
      <td>10199</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9956</td>
      <td>10179</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>7896</td>
      <td>10243</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>10192</td>
      <td>9931</td>
      <td>4</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 10 columns</p>
</div>



- Make the match result column that will be our target variable in the modeling.
    - match_result: home_win / draw / away_win


```python
home_win_bool = df_match_basic.home_team_goal > df_match_basic.away_team_goal
draw_bool = df_match_basic.home_team_goal == df_match_basic.away_team_goal
away_win_bool = df_match_basic.home_team_goal < df_match_basic.away_team_goal

df_match_basic.loc[home_win_bool, "match_result"] = "home_win"
df_match_basic.loc[draw_bool, "match_result"] = "draw"
df_match_basic.loc[away_win_bool, "match_result"] = "away_win"

df_match_basic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>match_date</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>match_result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>draw</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>draw</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>away_win</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9991</td>
      <td>9998</td>
      <td>5</td>
      <td>0</td>
      <td>home_win</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>7947</td>
      <td>9985</td>
      <td>1</td>
      <td>3</td>
      <td>away_win</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>10190</td>
      <td>10191</td>
      <td>1</td>
      <td>0</td>
      <td>home_win</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9824</td>
      <td>10199</td>
      <td>1</td>
      <td>2</td>
      <td>away_win</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9956</td>
      <td>10179</td>
      <td>2</td>
      <td>0</td>
      <td>home_win</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>7896</td>
      <td>10243</td>
      <td>0</td>
      <td>0</td>
      <td>draw</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>10192</td>
      <td>9931</td>
      <td>4</td>
      <td>3</td>
      <td>home_win</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 11 columns</p>
</div>




```python
df_match_basic.to_csv("../data/df_match_basic.csv", index = False)
```

## 2.2. Player information


```python
player_col = ["match_api_id", 'home_player_X1', 'home_player_X2', 'home_player_X3', 'home_player_X4', 'home_player_X5', 
              'home_player_X6', 'home_player_X7', 'home_player_X8', 'home_player_X9', 'home_player_X10', 
              'home_player_X11', 'away_player_X1', 'away_player_X2', 'away_player_X3', 'away_player_X4', 
              'away_player_X5', 'away_player_X6', 'away_player_X7', 'away_player_X8', 'away_player_X9', 
              'away_player_X10', 'away_player_X11', 'home_player_Y1', 'home_player_Y2', 'home_player_Y3', 
              'home_player_Y4', 'home_player_Y5', 'home_player_Y6', 'home_player_Y7', 'home_player_Y8', 
              'home_player_Y9', 'home_player_Y10', 'home_player_Y11', 'away_player_Y1', 'away_player_Y2', 
              'away_player_Y3', 'away_player_Y4', 'away_player_Y5', 'away_player_Y6', 'away_player_Y7', 
              'away_player_Y8', 'away_player_Y9', 'away_player_Y10', 'away_player_Y11', 'home_player_1', 
              'home_player_2', 'home_player_3', 'home_player_4', 'home_player_5', 'home_player_6', 
              'home_player_7', 'home_player_8', 'home_player_9', 'home_player_10', 'home_player_11', 
              'away_player_1', 'away_player_2', 'away_player_3', 'away_player_4', 'away_player_5', 
              'away_player_6', 'away_player_7', 'away_player_8', 'away_player_9', 'away_player_10', 'away_player_11']
```


```python
df_match_player = org_match[player_col]
df_match_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>home_player_Y8</th>
      <th>home_player_Y9</th>
      <th>home_player_Y10</th>
      <th>home_player_Y11</th>
      <th>away_player_Y1</th>
      <th>away_player_Y2</th>
      <th>away_player_Y3</th>
      <th>away_player_Y4</th>
      <th>away_player_Y5</th>
      <th>away_player_Y6</th>
      <th>away_player_Y7</th>
      <th>away_player_Y8</th>
      <th>away_player_Y9</th>
      <th>away_player_Y10</th>
      <th>away_player_Y11</th>
      <th>home_player_1</th>
      <th>home_player_2</th>
      <th>home_player_3</th>
      <th>home_player_4</th>
      <th>home_player_5</th>
      <th>home_player_6</th>
      <th>home_player_7</th>
      <th>home_player_8</th>
      <th>home_player_9</th>
      <th>home_player_10</th>
      <th>home_player_11</th>
      <th>away_player_1</th>
      <th>away_player_2</th>
      <th>away_player_3</th>
      <th>away_player_4</th>
      <th>away_player_5</th>
      <th>away_player_6</th>
      <th>away_player_7</th>
      <th>away_player_8</th>
      <th>away_player_9</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>42231.0</td>
      <td>678384.0</td>
      <td>95220.0</td>
      <td>638592.0</td>
      <td>413155.0</td>
      <td>45780.0</td>
      <td>171229.0</td>
      <td>67333.0</td>
      <td>119839.0</td>
      <td>143790.0</td>
      <td>195215.0</td>
      <td>462944.0</td>
      <td>563066.0</td>
      <td>8800.0</td>
      <td>67304.0</td>
      <td>158253.0</td>
      <td>133126.0</td>
      <td>186524.0</td>
      <td>93223.0</td>
      <td>121115.0</td>
      <td>232110.0</td>
      <td>289732.0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>33272.0</td>
      <td>41621.0</td>
      <td>25813.0</td>
      <td>257845.0</td>
      <td>114735.0</td>
      <td>42237.0</td>
      <td>113227.0</td>
      <td>358156.0</td>
      <td>32343.0</td>
      <td>531309.0</td>
      <td>37257.0</td>
      <td>42276.0</td>
      <td>114792.0</td>
      <td>150007.0</td>
      <td>178119.0</td>
      <td>27232.0</td>
      <td>570830.0</td>
      <td>260708.0</td>
      <td>201704.0</td>
      <td>36382.0</td>
      <td>34082.0</td>
      <td>95257.0</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>157856.0</td>
      <td>274779.0</td>
      <td>177689.0</td>
      <td>294256.0</td>
      <td>42258.0</td>
      <td>39979.0</td>
      <td>173936.0</td>
      <td>147959.0</td>
      <td>451983.0</td>
      <td>80564.0</td>
      <td>289472.0</td>
      <td>10637.0</td>
      <td>67349.0</td>
      <td>202663.0</td>
      <td>32597.0</td>
      <td>114794.0</td>
      <td>188114.0</td>
      <td>25840.0</td>
      <td>482200.0</td>
      <td>95230.0</td>
      <td>451335.0</td>
      <td>275122.0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>8881.0</td>
      <td>173534.0</td>
      <td>39646.0</td>
      <td>282287.0</td>
      <td>340790.0</td>
      <td>393337.0</td>
      <td>8893.0</td>
      <td>614454.0</td>
      <td>93229.0</td>
      <td>178142.0</td>
      <td>274776.0</td>
      <td>121080.0</td>
      <td>197757.0</td>
      <td>260964.0</td>
      <td>231614.0</td>
      <td>113235.0</td>
      <td>41116.0</td>
      <td>462608.0</td>
      <td>42262.0</td>
      <td>92252.0</td>
      <td>194532.0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>274787.0</td>
      <td>492132.0</td>
      <td>108451.0</td>
      <td>25815.0</td>
      <td>94553.0</td>
      <td>384376.0</td>
      <td>598355.0</td>
      <td>36785.0</td>
      <td>45174.0</td>
      <td>302079.0</td>
      <td>71764.0</td>
      <td>156175.0</td>
      <td>95216.0</td>
      <td>172768.0</td>
      <td>22834.0</td>
      <td>458806.0</td>
      <td>207234.0</td>
      <td>25772.0</td>
      <td>40274.0</td>
      <td>34035.0</td>
      <td>41726.0</td>
      <td>527103.0</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 67 columns</p>
</div>




```python
df_match_player.to_csv("../data/df_match_player.csv", index = False)
```

## 2.3. Betting information


```python
betting_col = ["match_api_id", 'B365H', 'B365D', 'B365A', 'BWH', 'BWD', 'BWA', 'IWH', 'IWD', 'IWA', 'LBH', 
               'LBD', 'LBA', 'PSH', 'PSD', 'PSA', 'WHH', 'WHD', 'WHA', 'SJH', 'SJD', 
               'SJA', 'VCH', 'VCD', 'VCA', 'GBH', 'GBD', 'GBA', 'BSH', 'BSD', 'BSA']
```


```python
df_match_betting = org_match[betting_col]
df_match_betting
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.35</td>
      <td>4.20</td>
      <td>1.85</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.80</td>
      <td>3.3</td>
      <td>3.75</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.70</td>
      <td>3.30</td>
      <td>4.33</td>
      <td>1.90</td>
      <td>3.3</td>
      <td>4.00</td>
      <td>1.65</td>
      <td>3.40</td>
      <td>4.50</td>
      <td>1.78</td>
      <td>3.25</td>
      <td>4.00</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>1.95</td>
      <td>3.20</td>
      <td>3.60</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.95</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.83</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>1.95</td>
      <td>3.3</td>
      <td>3.80</td>
      <td>2.00</td>
      <td>3.25</td>
      <td>3.25</td>
      <td>1.85</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>2.38</td>
      <td>3.30</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.30</td>
      <td>2.55</td>
      <td>2.60</td>
      <td>3.1</td>
      <td>2.3</td>
      <td>2.50</td>
      <td>3.2</td>
      <td>2.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.50</td>
      <td>3.25</td>
      <td>2.40</td>
      <td>2.63</td>
      <td>3.3</td>
      <td>2.50</td>
      <td>2.35</td>
      <td>3.25</td>
      <td>2.65</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.50</td>
      <td>2.30</td>
      <td>3.20</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>7.50</td>
      <td>1.40</td>
      <td>4.00</td>
      <td>6.80</td>
      <td>1.40</td>
      <td>3.9</td>
      <td>6.0</td>
      <td>1.44</td>
      <td>3.6</td>
      <td>6.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.00</td>
      <td>1.44</td>
      <td>4.0</td>
      <td>7.50</td>
      <td>1.45</td>
      <td>3.75</td>
      <td>6.50</td>
      <td>1.50</td>
      <td>3.75</td>
      <td>5.50</td>
      <td>1.44</td>
      <td>3.75</td>
      <td>6.50</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>5.00</td>
      <td>3.50</td>
      <td>1.60</td>
      <td>4.00</td>
      <td>3.3</td>
      <td>1.7</td>
      <td>4.00</td>
      <td>3.4</td>
      <td>1.72</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>3.40</td>
      <td>1.70</td>
      <td>4.50</td>
      <td>3.5</td>
      <td>1.73</td>
      <td>4.50</td>
      <td>3.40</td>
      <td>1.65</td>
      <td>4.50</td>
      <td>3.50</td>
      <td>1.65</td>
      <td>4.75</td>
      <td>3.30</td>
      <td>1.67</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 31 columns</p>
</div>




```python
df_match_betting.to_csv("../data/df_match_betting.csv", index = False)
```

## 2.4. In-game information


```python
in_game_col = ["match_api_id", 'goal', "home_team_goal", "away_team_goal", 'shoton', 
               'shotoff', 'foulcommit', 'card', 'cross', 'corner', 
               'possession']

```


```python
df_match_ingame = org_match[in_game_col]
df_match_ingame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>goal</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>None</td>
      <td>1</td>
      <td>1</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>None</td>
      <td>0</td>
      <td>3</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>None</td>
      <td>5</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>None</td>
      <td>1</td>
      <td>3</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>None</td>
      <td>1</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>None</td>
      <td>1</td>
      <td>2</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>None</td>
      <td>2</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>None</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>None</td>
      <td>4</td>
      <td>3</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 11 columns</p>
</div>




```python
df_match_ingame[~df_match_ingame.goal.isna()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>goal</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1728</th>
      <td>489042</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>1</td>
      <td>1</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;56&lt;/comment&gt;&lt;event...</td>
    </tr>
    <tr>
      <th>1729</th>
      <td>489043</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>1</td>
      <td>0</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card /&gt;</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;65&lt;/comment&gt;&lt;event...</td>
    </tr>
    <tr>
      <th>1730</th>
      <td>489044</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>0</td>
      <td>1</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;45&lt;/comment&gt;&lt;event...</td>
    </tr>
    <tr>
      <th>1731</th>
      <td>489045</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>2</td>
      <td>1</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;shoton&gt;1&lt;/shoton&gt;&lt;/stat...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;crosses&gt;1&lt;/crosses&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;50&lt;/comment&gt;&lt;event...</td>
    </tr>
    <tr>
      <th>1732</th>
      <td>489046</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>4</td>
      <td>2</td>
      <td>&lt;shoton&gt;&lt;value&gt;&lt;stats&gt;&lt;blocked&gt;1&lt;/blocked&gt;&lt;/st...</td>
      <td>&lt;shotoff&gt;&lt;value&gt;&lt;stats&gt;&lt;shotoff&gt;1&lt;/shotoff&gt;&lt;/s...</td>
      <td>&lt;foulcommit&gt;&lt;value&gt;&lt;stats&gt;&lt;foulscommitted&gt;1&lt;/f...</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/sta...</td>
      <td>&lt;corner&gt;&lt;value&gt;&lt;stats&gt;&lt;corners&gt;1&lt;/corners&gt;&lt;/st...</td>
      <td>&lt;possession&gt;&lt;value&gt;&lt;comment&gt;51&lt;/comment&gt;&lt;event...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25944</th>
      <td>1992225</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;o&lt;/comment&gt;&lt;stats&gt;&lt;owngo...</td>
      <td>0</td>
      <td>1</td>
      <td>&lt;shoton /&gt;</td>
      <td>&lt;shotoff /&gt;</td>
      <td>&lt;foulcommit /&gt;</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross /&gt;</td>
      <td>&lt;corner /&gt;</td>
      <td>&lt;possession /&gt;</td>
    </tr>
    <tr>
      <th>25945</th>
      <td>1992226</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>3</td>
      <td>0</td>
      <td>&lt;shoton /&gt;</td>
      <td>&lt;shotoff /&gt;</td>
      <td>&lt;foulcommit /&gt;</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross /&gt;</td>
      <td>&lt;corner /&gt;</td>
      <td>&lt;possession /&gt;</td>
    </tr>
    <tr>
      <th>25946</th>
      <td>1992227</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>2</td>
      <td>2</td>
      <td>&lt;shoton /&gt;</td>
      <td>&lt;shotoff /&gt;</td>
      <td>&lt;foulcommit /&gt;</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross /&gt;</td>
      <td>&lt;corner /&gt;</td>
      <td>&lt;possession /&gt;</td>
    </tr>
    <tr>
      <th>25947</th>
      <td>1992228</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>0</td>
      <td>3</td>
      <td>&lt;shoton /&gt;</td>
      <td>&lt;shotoff /&gt;</td>
      <td>&lt;foulcommit /&gt;</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross /&gt;</td>
      <td>&lt;corner /&gt;</td>
      <td>&lt;possession /&gt;</td>
    </tr>
    <tr>
      <th>25948</th>
      <td>1992229</td>
      <td>&lt;goal&gt;&lt;value&gt;&lt;comment&gt;n&lt;/comment&gt;&lt;stats&gt;&lt;goals...</td>
      <td>3</td>
      <td>1</td>
      <td>&lt;shoton /&gt;</td>
      <td>&lt;shotoff /&gt;</td>
      <td>&lt;foulcommit /&gt;</td>
      <td>&lt;card&gt;&lt;value&gt;&lt;comment&gt;y&lt;/comment&gt;&lt;stats&gt;&lt;ycard...</td>
      <td>&lt;cross /&gt;</td>
      <td>&lt;corner /&gt;</td>
      <td>&lt;possession /&gt;</td>
    </tr>
  </tbody>
</table>
<p>14217 rows × 11 columns</p>
</div>



- in-game related columns have xml format. 
- So we need to extract information from the xml data.
- Here is the information that we can extract from the in-game related columns: https://docs.google.com/spreadsheets/d/1EIwJc1YxI5Uf1-gNGdjgmreI0JLSSicH/edit?usp=sharing&ouid=103945379872439212801&rtpof=true&sd=true

- Extract the xml data from the goal column.


```python
df_match_ingame_goal = pd.DataFrame(columns = ["match_api_id", "goal_id", "goal_elapsed", "goal_team_api_id", "goal_player1_id", "goal_player2_id",
                                               "goal_type", "goal_subtype"])

for match_api_id in df_match_ingame[~df_match_ingame.goal.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].goal.values[0]
    
    goal_id = []
    goal_elapsed = []
    goal_team_id = []
    goal_player1_id = []
    goal_palyer2_id = []
    goal_type = []
    goal_subtype = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": goal_id.append(child.text)
            elif child.tag == "elapsed": goal_elapsed.append(child.text)
            elif child.tag == "team": goal_team_id.append(child.text)
            elif child.tag == "player1": goal_player1_id.append(child.text)
            elif child.tag == "player2": goal_palyer2_id.append(child.text)
            elif child.tag == "goal_type": goal_type.append(child.text)
            elif child.tag == "subtype": goal_subtype.append(child.text)
            
        if len(goal_id) != num_elmt: goal_id.append(np.nan)
        if len(goal_elapsed) != num_elmt: goal_elapsed.append(np.nan)
        if len(goal_team_id) != num_elmt: goal_team_id.append(np.nan)
        if len(goal_player1_id) != num_elmt: goal_player1_id.append(np.nan)
        if len(goal_palyer2_id) != num_elmt: goal_palyer2_id.append(np.nan)
        if len(goal_type) != num_elmt: goal_type.append(np.nan)
        if len(goal_subtype) != num_elmt: goal_subtype.append(np.nan)
        
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(goal_id),
                         "goal_id": goal_id,
                         "goal_elapsed": goal_elapsed,
                         "goal_team_api_id": goal_team_id,
                         "goal_player1_id": goal_player1_id,
                         "goal_player2_id": goal_palyer2_id,
                         "goal_type": goal_type,
                         "goal_subtype": goal_subtype})
    
    df_match_ingame_goal = pd.concat([df_match_ingame_goal, temp])
    
```


```python
df_match_ingame_goal
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>goal_id</th>
      <th>goal_elapsed</th>
      <th>goal_team_api_id</th>
      <th>goal_player1_id</th>
      <th>goal_player2_id</th>
      <th>goal_type</th>
      <th>goal_subtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378998</td>
      <td>22</td>
      <td>10261</td>
      <td>37799</td>
      <td>38807</td>
      <td>n</td>
      <td>header</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379019</td>
      <td>24</td>
      <td>10260</td>
      <td>24148</td>
      <td>24154</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375546</td>
      <td>4</td>
      <td>9825</td>
      <td>26181</td>
      <td>39297</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>378041</td>
      <td>83</td>
      <td>8650</td>
      <td>30853</td>
      <td>30889</td>
      <td>n</td>
      <td>distance</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489045</td>
      <td>376060</td>
      <td>4</td>
      <td>8654</td>
      <td>23139</td>
      <td>36394</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640015</td>
      <td>71</td>
      <td>10192</td>
      <td>37554</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639993</td>
      <td>58</td>
      <td>9824</td>
      <td>493418</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5640008</td>
      <td>67</td>
      <td>10243</td>
      <td>197757</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5640010</td>
      <td>69</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5640020</td>
      <td>76</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>39980 rows × 8 columns</p>
</div>



- Extract the xml data from the shoton and shotoff columns.


```python
df_match_ingame_shoton = pd.DataFrame(columns = ["match_api_id", "shot_id", "shot_elapsed", "shot_type", "shot_team_api_id", "shot_player1_id"])

for match_api_id in df_match_ingame[~df_match_ingame.shoton.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].shoton.values[0]
    
    shot_id = []
    shot_elapsed = []
    shot_type = []
    shot_team_id = []
    shot_player1_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": shot_id.append(child.text)
            elif child.tag == "elapsed": shot_elapsed.append(child.text)
            elif child.tag == "team": shot_team_id.append(child.text)
            elif child.tag == "player1": shot_player1_id.append(child.text)
            elif child.tag == "type": shot_type.append(child.text)
             
        if len(shot_id) != num_elmt: shot_id.append(np.nan)
        if len(shot_elapsed) != num_elmt: shot_elapsed.append(np.nan)
        if len(shot_team_id) != num_elmt: shot_team_id.append(np.nan)
        if len(shot_player1_id) != num_elmt: shot_player1_id.append(np.nan)
        if len(shot_type) != num_elmt: shot_type.append(np.nan)
        
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(shot_id),
                         "shot_id": shot_id,
                         "shot_elapsed": shot_elapsed,
                         "shot_type": shot_type,
                         "shot_team_api_id": shot_team_id,
                         "shot_player1_id": shot_player1_id})
    
    df_match_ingame_shoton = pd.concat([df_match_ingame_shoton, temp])
```


```python
df_match_ingame_shoton
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>shot_id</th>
      <th>shot_elapsed</th>
      <th>shot_type</th>
      <th>shot_team_api_id</th>
      <th>shot_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378828</td>
      <td>3</td>
      <td>shoton</td>
      <td>10260</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378866</td>
      <td>7</td>
      <td>shoton</td>
      <td>10260</td>
      <td>24157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378922</td>
      <td>14</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378923</td>
      <td>14</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30373</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378951</td>
      <td>17</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30373</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2030171</td>
      <td>4940770</td>
      <td>53</td>
      <td>shoton</td>
      <td>8370</td>
      <td>256727</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2030171</td>
      <td>4940869</td>
      <td>60</td>
      <td>shoton</td>
      <td>8558</td>
      <td>41622</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2030171</td>
      <td>4940889</td>
      <td>62</td>
      <td>shoton</td>
      <td>8370</td>
      <td>482331</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2030171</td>
      <td>4940940</td>
      <td>68</td>
      <td>shoton</td>
      <td>8370</td>
      <td>210065</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2030171</td>
      <td>4941144</td>
      <td>90</td>
      <td>shoton</td>
      <td>8558</td>
      <td>452243</td>
    </tr>
  </tbody>
</table>
<p>93755 rows × 6 columns</p>
</div>




```python
df_match_ingame_shotoff = pd.DataFrame(columns = ["match_api_id", "shot_id", "shot_elapsed", "shot_type", "shot_team_api_id", "shot_player1_id"])

for match_api_id in df_match_ingame[~df_match_ingame.shotoff.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].shotoff.values[0]
    
    shot_id = []
    shot_elapsed = []
    shot_type = []
    shot_team_id = []
    shot_player1_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": shot_id.append(child.text)
            elif child.tag == "elapsed": shot_elapsed.append(child.text)
            elif child.tag == "team": shot_team_id.append(child.text)
            elif child.tag == "player1": shot_player1_id.append(child.text)
            elif child.tag == "type": shot_type.append(child.text)
             
        if len(shot_id) != num_elmt: shot_id.append(np.nan)
        if len(shot_elapsed) != num_elmt: shot_elapsed.append(np.nan)
        if len(shot_team_id) != num_elmt: shot_team_id.append(np.nan)
        if len(shot_player1_id) != num_elmt: shot_player1_id.append(np.nan)
        if len(shot_type) != num_elmt: shot_type.append(np.nan)
        
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(shot_id),
                         "shot_id": shot_id,
                         "shot_elapsed": shot_elapsed,
                         "shot_type": shot_type,
                         "shot_team_api_id": shot_team_id,
                         "shot_player1_id": shot_player1_id})
    
    df_match_ingame_shotoff = pd.concat([df_match_ingame_shotoff, temp])
```


```python
df_match_ingame_shotoff
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>shot_id</th>
      <th>shot_elapsed</th>
      <th>shot_type</th>
      <th>shot_team_api_id</th>
      <th>shot_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378835</td>
      <td>4</td>
      <td>shotoff</td>
      <td>10260</td>
      <td>30373</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378845</td>
      <td>5</td>
      <td>shotoff</td>
      <td>10261</td>
      <td>37799</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378995</td>
      <td>22</td>
      <td>shotoff</td>
      <td>10261</td>
      <td>24228</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>379075</td>
      <td>31</td>
      <td>shotoff</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>379111</td>
      <td>34</td>
      <td>shotoff</td>
      <td>10260</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2030171</td>
      <td>4940379</td>
      <td>19</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>36130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2030171</td>
      <td>4940624</td>
      <td>44</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>34104</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030171</td>
      <td>4940738</td>
      <td>49</td>
      <td>shotoff</td>
      <td>8558</td>
      <td>107930</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2030171</td>
      <td>4940963</td>
      <td>71</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>210065</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2030171</td>
      <td>4941072</td>
      <td>83</td>
      <td>shotoff</td>
      <td>8558</td>
      <td>629579</td>
    </tr>
  </tbody>
</table>
<p>95303 rows × 6 columns</p>
</div>



- Merge the shoton and shotoff tables because they have same columns.


```python
df_match_ingame_shot = pd.concat([df_match_ingame_shoton, df_match_ingame_shotoff])
df_match_ingame_shot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>shot_id</th>
      <th>shot_elapsed</th>
      <th>shot_type</th>
      <th>shot_team_api_id</th>
      <th>shot_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378828</td>
      <td>3</td>
      <td>shoton</td>
      <td>10260</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378866</td>
      <td>7</td>
      <td>shoton</td>
      <td>10260</td>
      <td>24157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378922</td>
      <td>14</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378923</td>
      <td>14</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30373</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378951</td>
      <td>17</td>
      <td>shoton</td>
      <td>10260</td>
      <td>30373</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2030171</td>
      <td>4940379</td>
      <td>19</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>36130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2030171</td>
      <td>4940624</td>
      <td>44</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>34104</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030171</td>
      <td>4940738</td>
      <td>49</td>
      <td>shotoff</td>
      <td>8558</td>
      <td>107930</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2030171</td>
      <td>4940963</td>
      <td>71</td>
      <td>shotoff</td>
      <td>8370</td>
      <td>210065</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2030171</td>
      <td>4941072</td>
      <td>83</td>
      <td>shotoff</td>
      <td>8558</td>
      <td>629579</td>
    </tr>
  </tbody>
</table>
<p>189058 rows × 6 columns</p>
</div>




```python
len(df_match_ingame_shot.shot_id.unique())
```




    189058




```python
len(df_match_ingame_goal.goal_id.unique())
```




    39980




```python
len(pd.concat([df_match_ingame_goal.goal_id, df_match_ingame_shot.shot_id]).unique())
```




    229038



- Since goal and shot information are similar, let's combine two tables.


```python
df_match_ingame_goal
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>goal_id</th>
      <th>goal_elapsed</th>
      <th>goal_team_api_id</th>
      <th>goal_player1_id</th>
      <th>goal_player2_id</th>
      <th>goal_type</th>
      <th>goal_subtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378998</td>
      <td>22</td>
      <td>10261</td>
      <td>37799</td>
      <td>38807</td>
      <td>n</td>
      <td>header</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379019</td>
      <td>24</td>
      <td>10260</td>
      <td>24148</td>
      <td>24154</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375546</td>
      <td>4</td>
      <td>9825</td>
      <td>26181</td>
      <td>39297</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>378041</td>
      <td>83</td>
      <td>8650</td>
      <td>30853</td>
      <td>30889</td>
      <td>n</td>
      <td>distance</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489045</td>
      <td>376060</td>
      <td>4</td>
      <td>8654</td>
      <td>23139</td>
      <td>36394</td>
      <td>n</td>
      <td>shot</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640015</td>
      <td>71</td>
      <td>10192</td>
      <td>37554</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639993</td>
      <td>58</td>
      <td>9824</td>
      <td>493418</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5640008</td>
      <td>67</td>
      <td>10243</td>
      <td>197757</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5640010</td>
      <td>69</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5640020</td>
      <td>76</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
      <td>n</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>39980 rows × 8 columns</p>
</div>




```python
df_match_ingame_goal = df_match_ingame_goal.rename(columns = {"goal_id": "event_id", 
                                                              "goal_elapsed": "elapsed", 
                                                              "goal_team_api_id": "team_api_id",
                                                              "goal_player1_id": "player1_api_id",
                                                              "goal_player2_id": "player2_api_id",
                                                              "goal_type": "type", 
                                                              "goal_subtype": "subtype"})
```


```python
df_match_ingame_goal["category"] = "goal"
df_match_ingame_goal= df_match_ingame_goal[["match_api_id", "event_id", "elapsed", "team_api_id", "category", 
                                            "type", "subtype", "player1_api_id", "player2_api_id"]]
```


```python
df_match_ingame_goal
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>team_api_id</th>
      <th>category</th>
      <th>type</th>
      <th>subtype</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378998</td>
      <td>22</td>
      <td>10261</td>
      <td>goal</td>
      <td>n</td>
      <td>header</td>
      <td>37799</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379019</td>
      <td>24</td>
      <td>10260</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>24148</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375546</td>
      <td>4</td>
      <td>9825</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>26181</td>
      <td>39297</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>378041</td>
      <td>83</td>
      <td>8650</td>
      <td>goal</td>
      <td>n</td>
      <td>distance</td>
      <td>30853</td>
      <td>30889</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489045</td>
      <td>376060</td>
      <td>4</td>
      <td>8654</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>23139</td>
      <td>36394</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640015</td>
      <td>71</td>
      <td>10192</td>
      <td>goal</td>
      <td>n</td>
      <td>NaN</td>
      <td>37554</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639993</td>
      <td>58</td>
      <td>9824</td>
      <td>goal</td>
      <td>n</td>
      <td>NaN</td>
      <td>493418</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5640008</td>
      <td>67</td>
      <td>10243</td>
      <td>goal</td>
      <td>n</td>
      <td>NaN</td>
      <td>197757</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5640010</td>
      <td>69</td>
      <td>10243</td>
      <td>goal</td>
      <td>n</td>
      <td>NaN</td>
      <td>198082</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5640020</td>
      <td>76</td>
      <td>10243</td>
      <td>goal</td>
      <td>n</td>
      <td>NaN</td>
      <td>121080</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>39980 rows × 9 columns</p>
</div>




```python
df_match_ingame_shot = df_match_ingame_shot.rename(columns = {"shot_id": "event_id", 
                                                              "shot_elapsed": "elapsed", 
                                                              "shot_team_api_id": "team_api_id",
                                                              "shot_player1_id": "player1_api_id",
                                                              "shot_type": "type"})
```


```python
df_match_ingame_shot["category"] = "shot"
df_match_ingame_shot["subtype"] = np.nan 
df_match_ingame_shot["player2_api_id"] = np.nan 


df_match_ingame_shot= df_match_ingame_shot[["match_api_id", "event_id", "elapsed", "team_api_id", "category", 
                                            "type", "subtype", "player1_api_id", "player2_api_id"]]
```


```python
df_match_ingame_shot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>team_api_id</th>
      <th>category</th>
      <th>type</th>
      <th>subtype</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378828</td>
      <td>3</td>
      <td>10260</td>
      <td>shot</td>
      <td>shoton</td>
      <td>NaN</td>
      <td>24154</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378866</td>
      <td>7</td>
      <td>10260</td>
      <td>shot</td>
      <td>shoton</td>
      <td>NaN</td>
      <td>24157</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378922</td>
      <td>14</td>
      <td>10260</td>
      <td>shot</td>
      <td>shoton</td>
      <td>NaN</td>
      <td>30829</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378923</td>
      <td>14</td>
      <td>10260</td>
      <td>shot</td>
      <td>shoton</td>
      <td>NaN</td>
      <td>30373</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378951</td>
      <td>17</td>
      <td>10260</td>
      <td>shot</td>
      <td>shoton</td>
      <td>NaN</td>
      <td>30373</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2030171</td>
      <td>4940379</td>
      <td>19</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>36130</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2030171</td>
      <td>4940624</td>
      <td>44</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>34104</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030171</td>
      <td>4940738</td>
      <td>49</td>
      <td>8558</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>107930</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2030171</td>
      <td>4940963</td>
      <td>71</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>210065</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2030171</td>
      <td>4941072</td>
      <td>83</td>
      <td>8558</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>629579</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>189058 rows × 9 columns</p>
</div>




```python
df_match_ingame_shot = pd.concat([df_match_ingame_goal, df_match_ingame_shot])
df_match_ingame_shot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>team_api_id</th>
      <th>category</th>
      <th>type</th>
      <th>subtype</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378998</td>
      <td>22</td>
      <td>10261</td>
      <td>goal</td>
      <td>n</td>
      <td>header</td>
      <td>37799</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379019</td>
      <td>24</td>
      <td>10260</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>24148</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375546</td>
      <td>4</td>
      <td>9825</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>26181</td>
      <td>39297</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>378041</td>
      <td>83</td>
      <td>8650</td>
      <td>goal</td>
      <td>n</td>
      <td>distance</td>
      <td>30853</td>
      <td>30889</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489045</td>
      <td>376060</td>
      <td>4</td>
      <td>8654</td>
      <td>goal</td>
      <td>n</td>
      <td>shot</td>
      <td>23139</td>
      <td>36394</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2030171</td>
      <td>4940379</td>
      <td>19</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>36130</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2030171</td>
      <td>4940624</td>
      <td>44</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>34104</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030171</td>
      <td>4940738</td>
      <td>49</td>
      <td>8558</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>107930</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2030171</td>
      <td>4940963</td>
      <td>71</td>
      <td>8370</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>210065</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2030171</td>
      <td>4941072</td>
      <td>83</td>
      <td>8558</td>
      <td>shot</td>
      <td>shotoff</td>
      <td>NaN</td>
      <td>629579</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>229038 rows × 9 columns</p>
</div>




```python
df_match_ingame_shot.to_csv("../data/df_match_ingame_shot.csv", index = False)
```

- Extract the xml data from the foulcommit and card columns.


```python
df_match_ingame_foul = pd.DataFrame(columns = ["match_api_id", "foul_id", "foul_elapsed", "foul_type", "foul_team_api_id", 
                                               "foul_player1_id", "foul_player2_id"])

for match_api_id in df_match_ingame[~df_match_ingame.foulcommit.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].foulcommit.values[0]
    
    foul_id = []
    foul_elapsed = []
    foul_type = []
    foul_team_id = []
    foul_player1_id = []
    foul_player2_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": foul_id.append(child.text)
            elif child.tag == "elapsed": foul_elapsed.append(child.text)
            elif child.tag == "type": foul_type.append(child.text)
            elif child.tag == "team": foul_team_id.append(child.text)
            elif child.tag == "player1": foul_player1_id.append(child.text)
            elif child.tag == "player2": foul_player2_id.append(child.text)
            
             
        if len(foul_id) != num_elmt: foul_id.append(np.nan)
        if len(foul_elapsed) != num_elmt: foul_elapsed.append(np.nan)
        if len(foul_type) != num_elmt: foul_type.append(np.nan)
        if len(foul_team_id) != num_elmt: foul_team_id.append(np.nan)
        if len(foul_player1_id) != num_elmt: foul_player1_id.append(np.nan)
        if len(foul_player2_id) != num_elmt: foul_player2_id.append(np.nan)
    
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(foul_id),
                         "foul_id": foul_id,
                         "foul_elapsed": foul_elapsed,
                         "foul_type": foul_type,
                         "foul_team_api_id": foul_team_id,
                         "foul_player1_id": foul_player1_id,
                         "foul_player2_id": foul_player2_id,})
    
    df_match_ingame_foul = pd.concat([df_match_ingame_foul, temp])
```


```python
df_match_ingame_foul
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>foul_id</th>
      <th>foul_elapsed</th>
      <th>foul_type</th>
      <th>foul_team_api_id</th>
      <th>foul_player1_id</th>
      <th>foul_player2_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378824</td>
      <td>1</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>25518</td>
      <td>32569</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378826</td>
      <td>2</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>30929</td>
      <td>24157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378830</td>
      <td>3</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378841</td>
      <td>5</td>
      <td>foulcommit</td>
      <td>10260</td>
      <td>30373</td>
      <td>40565</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378894</td>
      <td>10</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2030171</td>
      <td>4941024</td>
      <td>77</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>213814</td>
      <td>40220</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2030171</td>
      <td>4941052</td>
      <td>79</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>452243</td>
      <td>75004</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2030171</td>
      <td>4941084</td>
      <td>81</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>629579</td>
      <td>75004</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2030171</td>
      <td>4941106</td>
      <td>88</td>
      <td>foulcommit</td>
      <td>8370</td>
      <td>210065</td>
      <td>37654</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2030171</td>
      <td>4941145</td>
      <td>90</td>
      <td>foulcommit</td>
      <td>8370</td>
      <td>183449</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>219234 rows × 7 columns</p>
</div>




```python
df_match_ingame_card = pd.DataFrame(columns = ["match_api_id", "card_id", "card_elapsed", "card_type", "card_team_api_id", "card_player1_id", "card_player2_id"])

for match_api_id in df_match_ingame[~df_match_ingame.card.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].card.values[0]
    
    card_id = []
    card_elapsed = []
    card_type = []
    card_team_id = []
    card_player1_id = []
    card_player2_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": card_id.append(child.text)
            elif child.tag == "elapsed": card_elapsed.append(child.text)
            elif child.tag == "card_type": card_type.append(child.text)
            elif child.tag == "team": card_team_id.append(child.text)
            elif child.tag == "player1": card_player1_id.append(child.text)
            elif child.tag == "player2": card_player2_id.append(child.text)
            
             
        if len(card_id) != num_elmt: card_id.append(np.nan)
        if len(card_elapsed) != num_elmt: card_elapsed.append(np.nan)
        if len(card_type) != num_elmt: card_type.append(np.nan)
        if len(card_team_id) != num_elmt: card_team_id.append(np.nan)
        if len(card_player1_id) != num_elmt: card_player1_id.append(np.nan)
        if len(card_player2_id) != num_elmt: card_player2_id.append(np.nan)
    
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(card_id),
                         "card_id": card_id,
                         "card_elapsed": card_elapsed,
                         "card_type": card_type,
                         "card_team_api_id": card_team_id,
                         "card_player1_id": card_player1_id,
                         "card_player2_id": card_player2_id,})
    
    df_match_ingame_card = pd.concat([df_match_ingame_card, temp])
```


```python
df_match_ingame_card
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>card_id</th>
      <th>card_elapsed</th>
      <th>card_type</th>
      <th>card_team_api_id</th>
      <th>card_player1_id</th>
      <th>card_player2_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>379481</td>
      <td>78</td>
      <td>y</td>
      <td>10260</td>
      <td>24157</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379503</td>
      <td>82</td>
      <td>y</td>
      <td>10260</td>
      <td>30362</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>379547</td>
      <td>90</td>
      <td>y</td>
      <td>10260</td>
      <td>30829</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>377978</td>
      <td>56</td>
      <td>y</td>
      <td>8650</td>
      <td>37442</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489044</td>
      <td>378060</td>
      <td>90</td>
      <td>y</td>
      <td>8650</td>
      <td>46621</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640034</td>
      <td>82</td>
      <td>y</td>
      <td>10192</td>
      <td>25815</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639986</td>
      <td>52</td>
      <td>y</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5639991</td>
      <td>56</td>
      <td>y</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5639996</td>
      <td>60</td>
      <td>y</td>
      <td>9824</td>
      <td>214344</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5639999</td>
      <td>61</td>
      <td>y</td>
      <td>9824</td>
      <td>294256</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>62114 rows × 7 columns</p>
</div>



- Since foul and card have similar information, let's combine two tables.


```python
df_match_ingame_foul = df_match_ingame_foul.rename(columns = {"foul_id": "event_id", 
                                                              "foul_elapsed": "elapsed",
                                                              "foul_team_api_id": "team_api_id", 
                                                              "foul_player1_id": "player1_api_id",
                                                              "foul_player2_id": "player2_api_id"})
```


```python
df_match_ingame_foul
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>foul_type</th>
      <th>team_api_id</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378824</td>
      <td>1</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>25518</td>
      <td>32569</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378826</td>
      <td>2</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>30929</td>
      <td>24157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378830</td>
      <td>3</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378841</td>
      <td>5</td>
      <td>foulcommit</td>
      <td>10260</td>
      <td>30373</td>
      <td>40565</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378894</td>
      <td>10</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2030171</td>
      <td>4941024</td>
      <td>77</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>213814</td>
      <td>40220</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2030171</td>
      <td>4941052</td>
      <td>79</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>452243</td>
      <td>75004</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2030171</td>
      <td>4941084</td>
      <td>81</td>
      <td>foulcommit</td>
      <td>8558</td>
      <td>629579</td>
      <td>75004</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2030171</td>
      <td>4941106</td>
      <td>88</td>
      <td>foulcommit</td>
      <td>8370</td>
      <td>210065</td>
      <td>37654</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2030171</td>
      <td>4941145</td>
      <td>90</td>
      <td>foulcommit</td>
      <td>8370</td>
      <td>183449</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>219234 rows × 7 columns</p>
</div>




```python
df_match_ingame_card
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>card_id</th>
      <th>card_elapsed</th>
      <th>card_type</th>
      <th>card_team_api_id</th>
      <th>card_player1_id</th>
      <th>card_player2_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>379481</td>
      <td>78</td>
      <td>y</td>
      <td>10260</td>
      <td>24157</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379503</td>
      <td>82</td>
      <td>y</td>
      <td>10260</td>
      <td>30362</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>379547</td>
      <td>90</td>
      <td>y</td>
      <td>10260</td>
      <td>30829</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>377978</td>
      <td>56</td>
      <td>y</td>
      <td>8650</td>
      <td>37442</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489044</td>
      <td>378060</td>
      <td>90</td>
      <td>y</td>
      <td>8650</td>
      <td>46621</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640034</td>
      <td>82</td>
      <td>y</td>
      <td>10192</td>
      <td>25815</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639986</td>
      <td>52</td>
      <td>y</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5639991</td>
      <td>56</td>
      <td>y</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5639996</td>
      <td>60</td>
      <td>y</td>
      <td>9824</td>
      <td>214344</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5639999</td>
      <td>61</td>
      <td>y</td>
      <td>9824</td>
      <td>294256</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>62114 rows × 7 columns</p>
</div>




```python
df_match_ingame_card = df_match_ingame_card.rename(columns = {"card_id": "event_id", 
                                                              "card_elapsed": "elapsed",
                                                              "card_type": "foul_type",
                                                              "card_team_api_id": "team_api_id", 
                                                              "card_player1_id": "player1_api_id",
                                                              "card_player2_id": "player2_api_id"})
```


```python
df_match_ingame_card
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>foul_type</th>
      <th>team_api_id</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>379481</td>
      <td>78</td>
      <td>y</td>
      <td>10260</td>
      <td>24157</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379503</td>
      <td>82</td>
      <td>y</td>
      <td>10260</td>
      <td>30362</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>379547</td>
      <td>90</td>
      <td>y</td>
      <td>10260</td>
      <td>30829</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489044</td>
      <td>377978</td>
      <td>56</td>
      <td>y</td>
      <td>8650</td>
      <td>37442</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489044</td>
      <td>378060</td>
      <td>90</td>
      <td>y</td>
      <td>8650</td>
      <td>46621</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640034</td>
      <td>82</td>
      <td>y</td>
      <td>10192</td>
      <td>25815</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639986</td>
      <td>52</td>
      <td>y</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5639991</td>
      <td>56</td>
      <td>y</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5639996</td>
      <td>60</td>
      <td>y</td>
      <td>9824</td>
      <td>214344</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5639999</td>
      <td>61</td>
      <td>y</td>
      <td>9824</td>
      <td>294256</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>62114 rows × 7 columns</p>
</div>




```python
df_match_ingame_foul = pd.concat([df_match_ingame_foul, df_match_ingame_card])
```


```python
df_match_ingame_foul
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>foul_type</th>
      <th>team_api_id</th>
      <th>player1_api_id</th>
      <th>player2_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378824</td>
      <td>1</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>25518</td>
      <td>32569</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378826</td>
      <td>2</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>30929</td>
      <td>24157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378830</td>
      <td>3</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378841</td>
      <td>5</td>
      <td>foulcommit</td>
      <td>10260</td>
      <td>30373</td>
      <td>40565</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378894</td>
      <td>10</td>
      <td>foulcommit</td>
      <td>10261</td>
      <td>29581</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992228</td>
      <td>5640034</td>
      <td>82</td>
      <td>y</td>
      <td>10192</td>
      <td>25815</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1992229</td>
      <td>5639986</td>
      <td>52</td>
      <td>y</td>
      <td>10243</td>
      <td>198082</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1992229</td>
      <td>5639991</td>
      <td>56</td>
      <td>y</td>
      <td>10243</td>
      <td>121080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1992229</td>
      <td>5639996</td>
      <td>60</td>
      <td>y</td>
      <td>9824</td>
      <td>214344</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1992229</td>
      <td>5639999</td>
      <td>61</td>
      <td>y</td>
      <td>9824</td>
      <td>294256</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>281348 rows × 7 columns</p>
</div>




```python
df_match_ingame_foul.to_csv("../data/df_match_ingame_foul.csv", index = False)
```

- Extract the xml data from the cross and corner columns.


```python
df_match_ingame_cross = pd.DataFrame(columns = ["match_api_id", "cross_id", "cross_elapsed", "cross_type", "cross_team_api_id", "cross_player1_id"])

for match_api_id in df_match_ingame[~df_match_ingame.cross.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].cross.values[0]
    
    cross_id = []
    cross_elapsed = []
    cross_type = []
    cross_team_id = []
    cross_player1_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": cross_id.append(child.text)
            elif child.tag == "elapsed": cross_elapsed.append(child.text)
            elif child.tag == "type": cross_type.append(child.text)
            elif child.tag == "team": cross_team_id.append(child.text)
            elif child.tag == "player1": cross_player1_id.append(child.text)
            
             
        if len(cross_id) != num_elmt: cross_id.append(np.nan)
        if len(cross_elapsed) != num_elmt: cross_elapsed.append(np.nan)
        if len(cross_type) != num_elmt: cross_type.append(np.nan)
        if len(cross_team_id) != num_elmt: cross_team_id.append(np.nan)
        if len(cross_player1_id) != num_elmt: cross_player1_id.append(np.nan)
    
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(cross_id),
                         "cross_id": cross_id,
                         "cross_elapsed": cross_elapsed,
                         "cross_type": cross_type,
                         "cross_team_api_id": cross_team_id,
                         "cross_player1_id": cross_player1_id})
    
    df_match_ingame_cross = pd.concat([df_match_ingame_cross, temp])
```


```python
df_match_ingame_cross
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>cross_id</th>
      <th>cross_elapsed</th>
      <th>cross_type</th>
      <th>cross_team_api_id</th>
      <th>cross_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378863</td>
      <td>7</td>
      <td>cross</td>
      <td>10260</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378921</td>
      <td>14</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378960</td>
      <td>19</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378970</td>
      <td>19</td>
      <td>cross</td>
      <td>10261</td>
      <td>30929</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378978</td>
      <td>20</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2030171</td>
      <td>4940945</td>
      <td>69</td>
      <td>cross</td>
      <td>8370</td>
      <td>210065</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2030171</td>
      <td>4940996</td>
      <td>74</td>
      <td>cross</td>
      <td>8370</td>
      <td>46808</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2030171</td>
      <td>4941050</td>
      <td>80</td>
      <td>cross</td>
      <td>8370</td>
      <td>210065</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2030171</td>
      <td>4941089</td>
      <td>85</td>
      <td>cross</td>
      <td>8370</td>
      <td>40220</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2030171</td>
      <td>4941100</td>
      <td>87</td>
      <td>cross</td>
      <td>8370</td>
      <td>40220</td>
    </tr>
  </tbody>
</table>
<p>284775 rows × 6 columns</p>
</div>




```python
df_match_ingame_cross.cross_type.unique()
```




    array(['cross', 'corner', 'throwin'], dtype=object)



- It seems that cross information alread include the corner information.


```python
df_match_ingame_corner = pd.DataFrame(columns = ["match_api_id", "corner_id", "corner_elapsed", "corner_type", "corner_team_api_id", "corner_player1_id"])

for match_api_id in df_match_ingame[~df_match_ingame.corner.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].corner.values[0]
    
    corner_id = []
    corner_elapsed = []
    corner_type = []
    corner_team_id = []
    corner_player1_id = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": corner_id.append(child.text)
            elif child.tag == "elapsed": corner_elapsed.append(child.text)
            elif child.tag == "type": corner_type.append(child.text)
            elif child.tag == "team": corner_team_id.append(child.text)
            elif child.tag == "player1": corner_player1_id.append(child.text)
            
             
        if len(corner_id) != num_elmt: corner_id.append(np.nan)
        if len(corner_elapsed) != num_elmt: corner_elapsed.append(np.nan)
        if len(corner_type) != num_elmt: corner_type.append(np.nan)
        if len(corner_team_id) != num_elmt: corner_team_id.append(np.nan)
        if len(corner_player1_id) != num_elmt: corner_player1_id.append(np.nan)
    
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(corner_id),
                         "corner_id": corner_id,
                         "corner_elapsed": corner_elapsed,
                         "corner_type": corner_type,
                         "corner_team_api_id": corner_team_id,
                         "corner_player1_id": corner_player1_id})
    
    df_match_ingame_corner = pd.concat([df_match_ingame_corner, temp])
```


```python
df_match_ingame_corner
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>corner_id</th>
      <th>corner_elapsed</th>
      <th>corner_type</th>
      <th>corner_team_api_id</th>
      <th>corner_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378960</td>
      <td>19</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378992</td>
      <td>22</td>
      <td>corner</td>
      <td>10261</td>
      <td>40565</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378996</td>
      <td>22</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>379352</td>
      <td>48</td>
      <td>corner</td>
      <td>10260</td>
      <td>24154</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>379366</td>
      <td>51</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2030171</td>
      <td>4940619</td>
      <td>44</td>
      <td>corner</td>
      <td>8370</td>
      <td>36130</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2030171</td>
      <td>4940734</td>
      <td>49</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2030171</td>
      <td>4940742</td>
      <td>50</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2030171</td>
      <td>4940990</td>
      <td>73</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2030171</td>
      <td>4941137</td>
      <td>90</td>
      <td>corner</td>
      <td>8370</td>
      <td>75004</td>
    </tr>
  </tbody>
</table>
<p>87839 rows × 6 columns</p>
</div>




```python
temp = df_match_ingame_cross.merge(df_match_ingame_corner.rename(columns = {"corner_elapsed": "cross_elapsed"}), how = "left", on = ["match_api_id", "cross_elapsed"])
temp
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>cross_id</th>
      <th>cross_elapsed</th>
      <th>cross_type</th>
      <th>cross_team_api_id</th>
      <th>cross_player1_id</th>
      <th>corner_id</th>
      <th>corner_type</th>
      <th>corner_team_api_id</th>
      <th>corner_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378863</td>
      <td>7</td>
      <td>cross</td>
      <td>10260</td>
      <td>30829</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378921</td>
      <td>14</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378960</td>
      <td>19</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
      <td>378960</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378970</td>
      <td>19</td>
      <td>cross</td>
      <td>10261</td>
      <td>30929</td>
      <td>378960</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378978</td>
      <td>20</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>296857</th>
      <td>2030171</td>
      <td>4940945</td>
      <td>69</td>
      <td>cross</td>
      <td>8370</td>
      <td>210065</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>296858</th>
      <td>2030171</td>
      <td>4940996</td>
      <td>74</td>
      <td>cross</td>
      <td>8370</td>
      <td>46808</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>296859</th>
      <td>2030171</td>
      <td>4941050</td>
      <td>80</td>
      <td>cross</td>
      <td>8370</td>
      <td>210065</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>296860</th>
      <td>2030171</td>
      <td>4941089</td>
      <td>85</td>
      <td>cross</td>
      <td>8370</td>
      <td>40220</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>296861</th>
      <td>2030171</td>
      <td>4941100</td>
      <td>87</td>
      <td>cross</td>
      <td>8370</td>
      <td>40220</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>296862 rows × 10 columns</p>
</div>




```python
len(df_match_ingame_corner.corner_id.unique())
```




    87839




```python
len(temp.corner_id.unique())
```




    63736



- 63736 corner information out of 87839 corner information alread included in the cross information.
- So we will only use the cross information combined with corner information that are not in the cross information.


```python
temp = df_match_ingame_corner[~df_match_ingame_corner.corner_id.isin(df_match_ingame_cross.cross_id)]
temp.columns = df_match_ingame_cross.columns 
temp
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>cross_id</th>
      <th>cross_elapsed</th>
      <th>cross_type</th>
      <th>cross_team_api_id</th>
      <th>cross_player1_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378992</td>
      <td>22</td>
      <td>corner</td>
      <td>10261</td>
      <td>40565</td>
    </tr>
    <tr>
      <th>6</th>
      <td>489042</td>
      <td>379411</td>
      <td>59</td>
      <td>corner</td>
      <td>10260</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375535</td>
      <td>3</td>
      <td>corner</td>
      <td>9825</td>
      <td>39297</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489043</td>
      <td>375562</td>
      <td>9</td>
      <td>corner</td>
      <td>9825</td>
      <td>30960</td>
    </tr>
    <tr>
      <th>6</th>
      <td>489045</td>
      <td>376655</td>
      <td>40</td>
      <td>corner</td>
      <td>8528</td>
      <td>35327</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2030171</td>
      <td>4940619</td>
      <td>44</td>
      <td>corner</td>
      <td>8370</td>
      <td>36130</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2030171</td>
      <td>4940734</td>
      <td>49</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2030171</td>
      <td>4940742</td>
      <td>50</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2030171</td>
      <td>4940990</td>
      <td>73</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2030171</td>
      <td>4941137</td>
      <td>90</td>
      <td>corner</td>
      <td>8370</td>
      <td>75004</td>
    </tr>
  </tbody>
</table>
<p>45588 rows × 6 columns</p>
</div>




```python
df_match_ingame_cross = pd.concat([df_match_ingame_cross, temp])
```


```python
df_match_ingame_cross = df_match_ingame_cross.rename(columns = {"cross_id": "event_id", 
                                                                "cross_elapsed": "elapsed", 
                                                                "cross_team_api_id": "team_api_id", 
                                                                "cross_player1_id": "player1_api_id"})
```


```python
df_match_ingame_cross
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>cross_type</th>
      <th>team_api_id</th>
      <th>player1_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>378863</td>
      <td>7</td>
      <td>cross</td>
      <td>10260</td>
      <td>30829</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>378921</td>
      <td>14</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>378960</td>
      <td>19</td>
      <td>corner</td>
      <td>10261</td>
      <td>38807</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>378970</td>
      <td>19</td>
      <td>cross</td>
      <td>10261</td>
      <td>30929</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489042</td>
      <td>378978</td>
      <td>20</td>
      <td>cross</td>
      <td>10260</td>
      <td>24148</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2030171</td>
      <td>4940619</td>
      <td>44</td>
      <td>corner</td>
      <td>8370</td>
      <td>36130</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2030171</td>
      <td>4940734</td>
      <td>49</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2030171</td>
      <td>4940742</td>
      <td>50</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2030171</td>
      <td>4940990</td>
      <td>73</td>
      <td>corner</td>
      <td>8558</td>
      <td>498033</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2030171</td>
      <td>4941137</td>
      <td>90</td>
      <td>corner</td>
      <td>8370</td>
      <td>75004</td>
    </tr>
  </tbody>
</table>
<p>330363 rows × 6 columns</p>
</div>




```python
df_match_ingame_cross.to_csv("../data/df_match_ingame_cross.csv", index = False)
```

- Extract the xml data from the possesion column.


```python
df_match_ingame_possesion = pd.DataFrame(columns = ["match_api_id", "pos_id", "pos_elapsed", "pos_home", "pos_away"])

for match_api_id in df_match_ingame[~df_match_ingame.possession.isna()].match_api_id.unique():
    xml = df_match_ingame[df_match_ingame.match_api_id == match_api_id].possession.values[0]
    
    pos_id = []
    pos_elapsed = []
    pos_home = [] 
    pos_away = []
    num_elmt = 0
    
    for item in ET.fromstring(xml).findall(".value"):
        num_elmt += 1
        
        for child in item:
            if child.tag == "id": pos_id.append(child.text)
            elif child.tag == "elapsed": pos_elapsed.append(child.text)
            elif child.tag == "homepos": pos_home.append(child.text)
            elif child.tag == "awaypos": pos_away.append(child.text)
            
            
             
        if len(pos_id) != num_elmt: pos_id.append(np.nan)
        if len(pos_elapsed) != num_elmt: pos_elapsed.append(np.nan)
        if len(pos_home) != num_elmt: pos_home.append(np.nan)
        if len(pos_away) != num_elmt: pos_away.append(np.nan)
    
    temp = pd.DataFrame({"match_api_id": [match_api_id] * len(pos_id),
                         "pos_id": pos_id,
                         "pos_elapsed": pos_elapsed,
                         "pos_home": pos_home,
                         "pos_away": pos_away})
    
    df_match_ingame_possesion = pd.concat([df_match_ingame_possesion, temp])
```


```python
df_match_ingame_possesion = df_match_ingame_possesion.rename(columns = {"pos_id": "event_id", 
                                                          "pos_elapsed": "elapsed", 
                                                          "pos_home": "home_possession", 
                                                          "pos_away": "away_possession"})
```


```python
df_match_ingame_possesion
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>home_possession</th>
      <th>away_possession</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>379029</td>
      <td>25</td>
      <td>56</td>
      <td>44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379251</td>
      <td>45</td>
      <td>54</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>379443</td>
      <td>70</td>
      <td>54</td>
      <td>46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>379575</td>
      <td>90</td>
      <td>55</td>
      <td>45</td>
    </tr>
    <tr>
      <th>0</th>
      <td>489043</td>
      <td>375608</td>
      <td>27</td>
      <td>65</td>
      <td>35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030170</td>
      <td>4947481</td>
      <td>85</td>
      <td>45</td>
      <td>55</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2030171</td>
      <td>4940420</td>
      <td>22</td>
      <td>59</td>
      <td>41</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2030171</td>
      <td>4940639</td>
      <td>45</td>
      <td>61</td>
      <td>39</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2030171</td>
      <td>4940941</td>
      <td>68</td>
      <td>60</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2030171</td>
      <td>4941128</td>
      <td>90</td>
      <td>62</td>
      <td>38</td>
    </tr>
  </tbody>
</table>
<p>34815 rows × 5 columns</p>
</div>



- Since we need home team and away team api id, find and combine team ids by the match api id.


```python
df_match_basic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>match_date</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9987</td>
      <td>9993</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>10000</td>
      <td>9994</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>9984</td>
      <td>8635</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17</td>
      <td>9991</td>
      <td>9998</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16</td>
      <td>7947</td>
      <td>9985</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>10190</td>
      <td>10191</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9824</td>
      <td>10199</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>9956</td>
      <td>10179</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-22</td>
      <td>7896</td>
      <td>10243</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>24558</td>
      <td>24558</td>
      <td>2015/2016</td>
      <td>9</td>
      <td>2015-09-23</td>
      <td>10192</td>
      <td>9931</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 8 columns</p>
</div>




```python
df_match_ingame_possesion = df_match_ingame_possesion.merge(df_match_basic[["match_api_id", "home_team_api_id", "away_team_api_id"]], how = "left", on = "match_api_id") \
    [["match_api_id", "event_id", "elapsed", "home_team_api_id", "home_possession", "away_team_api_id", "away_possession"]]
```


```python
df_match_ingame_possesion
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>event_id</th>
      <th>elapsed</th>
      <th>home_team_api_id</th>
      <th>home_possession</th>
      <th>away_team_api_id</th>
      <th>away_possession</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>489042</td>
      <td>379029</td>
      <td>25</td>
      <td>10260</td>
      <td>56</td>
      <td>10261</td>
      <td>44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>489042</td>
      <td>379251</td>
      <td>45</td>
      <td>10260</td>
      <td>54</td>
      <td>10261</td>
      <td>46</td>
    </tr>
    <tr>
      <th>2</th>
      <td>489042</td>
      <td>379443</td>
      <td>70</td>
      <td>10260</td>
      <td>54</td>
      <td>10261</td>
      <td>46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>489042</td>
      <td>379575</td>
      <td>90</td>
      <td>10260</td>
      <td>55</td>
      <td>10261</td>
      <td>45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>489043</td>
      <td>375608</td>
      <td>27</td>
      <td>9825</td>
      <td>65</td>
      <td>8659</td>
      <td>35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>34810</th>
      <td>2030170</td>
      <td>4947481</td>
      <td>85</td>
      <td>7878</td>
      <td>45</td>
      <td>8603</td>
      <td>55</td>
    </tr>
    <tr>
      <th>34811</th>
      <td>2030171</td>
      <td>4940420</td>
      <td>22</td>
      <td>8370</td>
      <td>59</td>
      <td>8558</td>
      <td>41</td>
    </tr>
    <tr>
      <th>34812</th>
      <td>2030171</td>
      <td>4940639</td>
      <td>45</td>
      <td>8370</td>
      <td>61</td>
      <td>8558</td>
      <td>39</td>
    </tr>
    <tr>
      <th>34813</th>
      <td>2030171</td>
      <td>4940941</td>
      <td>68</td>
      <td>8370</td>
      <td>60</td>
      <td>8558</td>
      <td>40</td>
    </tr>
    <tr>
      <th>34814</th>
      <td>2030171</td>
      <td>4941128</td>
      <td>90</td>
      <td>8370</td>
      <td>62</td>
      <td>8558</td>
      <td>38</td>
    </tr>
  </tbody>
</table>
<p>34815 rows × 7 columns</p>
</div>




```python
df_match_ingame_possesion.to_csv("../data/df_match_ingame_possesion.csv", index = False)
```

## <font color="magenta">2.5. Summary</font>

![df_match_1](/assets/images/projects/european_soccer_prediction/df_match_1.png)

![df_match_2](/assets/images/projects/european_soccer_prediction/df_match_2.png)

# 3. Team related tables: Country, League, Team, Team_Attributes

## 3.1. Country


```python
org_country = pd.read_sql(
    "select * from Country", con
    )

org_country
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Belgium</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1729</td>
      <td>England</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4769</td>
      <td>France</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7809</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10257</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13274</td>
      <td>Netherlands</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15722</td>
      <td>Poland</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17642</td>
      <td>Portugal</td>
    </tr>
    <tr>
      <th>8</th>
      <td>19694</td>
      <td>Scotland</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21518</td>
      <td>Spain</td>
    </tr>
    <tr>
      <th>10</th>
      <td>24558</td>
      <td>Switzerland</td>
    </tr>
  </tbody>
</table>
</div>



- There are total 11 countries.

## 3.2. League


```python
org_league = pd.read_sql(
    "select * from League", con
    )

org_league
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>Belgium Jupiler League</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1729</td>
      <td>1729</td>
      <td>England Premier League</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4769</td>
      <td>4769</td>
      <td>France Ligue 1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7809</td>
      <td>7809</td>
      <td>Germany 1. Bundesliga</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10257</td>
      <td>10257</td>
      <td>Italy Serie A</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13274</td>
      <td>13274</td>
      <td>Netherlands Eredivisie</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15722</td>
      <td>15722</td>
      <td>Poland Ekstraklasa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17642</td>
      <td>17642</td>
      <td>Portugal Liga ZON Sagres</td>
    </tr>
    <tr>
      <th>8</th>
      <td>19694</td>
      <td>19694</td>
      <td>Scotland Premier League</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21518</td>
      <td>21518</td>
      <td>Spain LIGA BBVA</td>
    </tr>
    <tr>
      <th>10</th>
      <td>24558</td>
      <td>24558</td>
      <td>Switzerland Super League</td>
    </tr>
  </tbody>
</table>
</div>



- There are total 11 leagues from different countries.
- Since there is only one league per country, country and league represent the same information.
- Since we can get the country information from the league name, let's do not use the country and only use the league table later.

## 3.3. Team


```python
org_team = pd.read_sql(
    "select * from Team", con
    )

org_team.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>team_api_id</th>
      <th>team_fifa_api_id</th>
      <th>team_long_name</th>
      <th>team_short_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>9987</td>
      <td>673.0</td>
      <td>KRC Genk</td>
      <td>GEN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>9993</td>
      <td>675.0</td>
      <td>Beerschot AC</td>
      <td>BAC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>10000</td>
      <td>15005.0</td>
      <td>SV Zulte-Waregem</td>
      <td>ZUL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>9994</td>
      <td>2007.0</td>
      <td>Sporting Lokeren</td>
      <td>LOK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>9984</td>
      <td>1750.0</td>
      <td>KSV Cercle Brugge</td>
      <td>CEB</td>
    </tr>
  </tbody>
</table>
</div>



- Since team_long_name and team_short_name have same information, we will only use the team_long_name.


```python
org_team.shape
```




    (299, 5)




```python
len(org_team.team_api_id.unique())
```




    299




```python
len(org_team.team_fifa_api_id.unique())
```




    286




```python
org_team.isna().sum()
```




    id                   0
    team_api_id          0
    team_fifa_api_id    11
    team_long_name       0
    team_short_name      0
    dtype: int64



- team_api_id and team_fifa_api_id have different number of unique values because team_fifa_api_id has 11 missing values.
- So it is better to use team_api rather than use team_fifa_api_id to merge tables later.
- There are 299 teams.

## 3.4. Team_Attributes


```python
org_team_attr = pd.read_sql(
    "select * from Team_Attributes", con
    )

org_team_attr.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>team_fifa_api_id</th>
      <th>team_api_id</th>
      <th>date</th>
      <th>buildUpPlaySpeed</th>
      <th>buildUpPlaySpeedClass</th>
      <th>buildUpPlayDribbling</th>
      <th>buildUpPlayDribblingClass</th>
      <th>buildUpPlayPassing</th>
      <th>buildUpPlayPassingClass</th>
      <th>buildUpPlayPositioningClass</th>
      <th>chanceCreationPassing</th>
      <th>chanceCreationPassingClass</th>
      <th>chanceCreationCrossing</th>
      <th>chanceCreationCrossingClass</th>
      <th>chanceCreationShooting</th>
      <th>chanceCreationShootingClass</th>
      <th>chanceCreationPositioningClass</th>
      <th>defencePressure</th>
      <th>defencePressureClass</th>
      <th>defenceAggression</th>
      <th>defenceAggressionClass</th>
      <th>defenceTeamWidth</th>
      <th>defenceTeamWidthClass</th>
      <th>defenceDefenderLineClass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>434</td>
      <td>9930</td>
      <td>2010-02-22 00:00:00</td>
      <td>60</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>50</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>60</td>
      <td>Normal</td>
      <td>65</td>
      <td>Normal</td>
      <td>55</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>50</td>
      <td>Medium</td>
      <td>55</td>
      <td>Press</td>
      <td>45</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>434</td>
      <td>9930</td>
      <td>2014-09-19 00:00:00</td>
      <td>52</td>
      <td>Balanced</td>
      <td>48.0</td>
      <td>Normal</td>
      <td>56</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>434</td>
      <td>9930</td>
      <td>2015-09-10 00:00:00</td>
      <td>47</td>
      <td>Balanced</td>
      <td>41.0</td>
      <td>Normal</td>
      <td>54</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>77</td>
      <td>8485</td>
      <td>2010-02-22 00:00:00</td>
      <td>70</td>
      <td>Fast</td>
      <td>NaN</td>
      <td>Little</td>
      <td>70</td>
      <td>Long</td>
      <td>Organised</td>
      <td>70</td>
      <td>Risky</td>
      <td>70</td>
      <td>Lots</td>
      <td>70</td>
      <td>Lots</td>
      <td>Organised</td>
      <td>60</td>
      <td>Medium</td>
      <td>70</td>
      <td>Double</td>
      <td>70</td>
      <td>Wide</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>77</td>
      <td>8485</td>
      <td>2011-02-22 00:00:00</td>
      <td>47</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>52</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>53</td>
      <td>Normal</td>
      <td>48</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>47</td>
      <td>Press</td>
      <td>52</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>
</div>




```python
org_team_attr.shape
```




    (1458, 25)



- There are 21 team attributes.


```python
len(org_team_attr.team_api_id.unique())
```




    288



- The number of teams that have team attributes are 288 out of total 299 teams. 
- This is because the team attributes were collected by team_fifa_api_id, which has 11 missing values.
- <font color="magenta">**Note**: Team attributes are important features, so I think matches of teams without team attributes should be excluded from the analysis later. </font> 

## 3.5. Merge all team related tables


```python
team_country_info = pd.concat([df_match_basic[["home_team_api_id", "country_id"]].rename(columns = {"home_team_api_id": "team_api_id"}) ,
                               df_match_basic[["away_team_api_id", "country_id"]].rename(columns = {"away_team_api_id": "team_api_id"})]).drop_duplicates()
```


```python
df_team = org_team_attr.merge(team_country_info, how = "left", on = "team_api_id") \
                       .merge(org_league.rename(columns = {"name": "league_name"}), how = "left", on = "country_id") \
                       .merge(org_team, how = "left", on = "team_api_id") 
```


```python
df_team.date
```




    0       2010-02-22 00:00:00
    1       2014-09-19 00:00:00
    2       2015-09-10 00:00:00
    3       2010-02-22 00:00:00
    4       2011-02-22 00:00:00
                   ...         
    1453    2011-02-22 00:00:00
    1454    2012-02-22 00:00:00
    1455    2013-09-20 00:00:00
    1456    2014-09-19 00:00:00
    1457    2015-09-10 00:00:00
    Name: date, Length: 1458, dtype: object



- Since there are other date columns that have different meanings in other tables, let's change the column name date in this table to the player_measured_date.


```python
df_team["team_measured_date"] = pd.to_datetime(df_team.date)
```


```python
df_team = df_team[["team_api_id", "team_long_name", "league_name", "team_measured_date",
                  'buildUpPlaySpeed', 'buildUpPlaySpeedClass', 'buildUpPlayDribbling','buildUpPlayDribblingClass', 
                  'buildUpPlayPassing', 'buildUpPlayPassingClass', 'buildUpPlayPositioningClass', 'chanceCreationPassing', 
                  'chanceCreationPassingClass','chanceCreationCrossing', 'chanceCreationCrossingClass', 'chanceCreationShooting', 
                  'chanceCreationShootingClass','chanceCreationPositioningClass', 'defencePressure', 'defencePressureClass', 
                  'defenceAggression', 'defenceAggressionClass', 'defenceTeamWidth', 'defenceTeamWidthClass',
                  'defenceDefenderLineClass']]
df_team
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_api_id</th>
      <th>team_long_name</th>
      <th>league_name</th>
      <th>team_measured_date</th>
      <th>buildUpPlaySpeed</th>
      <th>buildUpPlaySpeedClass</th>
      <th>buildUpPlayDribbling</th>
      <th>buildUpPlayDribblingClass</th>
      <th>buildUpPlayPassing</th>
      <th>buildUpPlayPassingClass</th>
      <th>buildUpPlayPositioningClass</th>
      <th>chanceCreationPassing</th>
      <th>chanceCreationPassingClass</th>
      <th>chanceCreationCrossing</th>
      <th>chanceCreationCrossingClass</th>
      <th>chanceCreationShooting</th>
      <th>chanceCreationShootingClass</th>
      <th>chanceCreationPositioningClass</th>
      <th>defencePressure</th>
      <th>defencePressureClass</th>
      <th>defenceAggression</th>
      <th>defenceAggressionClass</th>
      <th>defenceTeamWidth</th>
      <th>defenceTeamWidthClass</th>
      <th>defenceDefenderLineClass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9930</td>
      <td>FC Aarau</td>
      <td>Switzerland Super League</td>
      <td>2010-02-22</td>
      <td>60</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>50</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>60</td>
      <td>Normal</td>
      <td>65</td>
      <td>Normal</td>
      <td>55</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>50</td>
      <td>Medium</td>
      <td>55</td>
      <td>Press</td>
      <td>45</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9930</td>
      <td>FC Aarau</td>
      <td>Switzerland Super League</td>
      <td>2014-09-19</td>
      <td>52</td>
      <td>Balanced</td>
      <td>48.0</td>
      <td>Normal</td>
      <td>56</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9930</td>
      <td>FC Aarau</td>
      <td>Switzerland Super League</td>
      <td>2015-09-10</td>
      <td>47</td>
      <td>Balanced</td>
      <td>41.0</td>
      <td>Normal</td>
      <td>54</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>54</td>
      <td>Normal</td>
      <td>63</td>
      <td>Normal</td>
      <td>64</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>44</td>
      <td>Press</td>
      <td>54</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8485</td>
      <td>Aberdeen</td>
      <td>Scotland Premier League</td>
      <td>2010-02-22</td>
      <td>70</td>
      <td>Fast</td>
      <td>NaN</td>
      <td>Little</td>
      <td>70</td>
      <td>Long</td>
      <td>Organised</td>
      <td>70</td>
      <td>Risky</td>
      <td>70</td>
      <td>Lots</td>
      <td>70</td>
      <td>Lots</td>
      <td>Organised</td>
      <td>60</td>
      <td>Medium</td>
      <td>70</td>
      <td>Double</td>
      <td>70</td>
      <td>Wide</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8485</td>
      <td>Aberdeen</td>
      <td>Scotland Premier League</td>
      <td>2011-02-22</td>
      <td>47</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>52</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>53</td>
      <td>Normal</td>
      <td>48</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>47</td>
      <td>Medium</td>
      <td>47</td>
      <td>Press</td>
      <td>52</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1453</th>
      <td>10000</td>
      <td>SV Zulte-Waregem</td>
      <td>Belgium Jupiler League</td>
      <td>2011-02-22</td>
      <td>52</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>52</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>52</td>
      <td>Normal</td>
      <td>48</td>
      <td>Normal</td>
      <td>53</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>46</td>
      <td>Medium</td>
      <td>48</td>
      <td>Press</td>
      <td>53</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1454</th>
      <td>10000</td>
      <td>SV Zulte-Waregem</td>
      <td>Belgium Jupiler League</td>
      <td>2012-02-22</td>
      <td>54</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>51</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>50</td>
      <td>Normal</td>
      <td>Organised</td>
      <td>44</td>
      <td>Medium</td>
      <td>55</td>
      <td>Press</td>
      <td>53</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>10000</td>
      <td>SV Zulte-Waregem</td>
      <td>Belgium Jupiler League</td>
      <td>2013-09-20</td>
      <td>54</td>
      <td>Balanced</td>
      <td>NaN</td>
      <td>Little</td>
      <td>51</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>32</td>
      <td>Little</td>
      <td>Organised</td>
      <td>44</td>
      <td>Medium</td>
      <td>58</td>
      <td>Press</td>
      <td>37</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>10000</td>
      <td>SV Zulte-Waregem</td>
      <td>Belgium Jupiler League</td>
      <td>2014-09-19</td>
      <td>54</td>
      <td>Balanced</td>
      <td>42.0</td>
      <td>Normal</td>
      <td>51</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>32</td>
      <td>Little</td>
      <td>Organised</td>
      <td>44</td>
      <td>Medium</td>
      <td>58</td>
      <td>Press</td>
      <td>37</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>10000</td>
      <td>SV Zulte-Waregem</td>
      <td>Belgium Jupiler League</td>
      <td>2015-09-10</td>
      <td>54</td>
      <td>Balanced</td>
      <td>42.0</td>
      <td>Normal</td>
      <td>51</td>
      <td>Mixed</td>
      <td>Organised</td>
      <td>47</td>
      <td>Normal</td>
      <td>52</td>
      <td>Normal</td>
      <td>32</td>
      <td>Little</td>
      <td>Organised</td>
      <td>44</td>
      <td>Medium</td>
      <td>58</td>
      <td>Press</td>
      <td>37</td>
      <td>Normal</td>
      <td>Cover</td>
    </tr>
  </tbody>
</table>
<p>1458 rows × 25 columns</p>
</div>




```python
team_api_id_grouped_count = df_team.groupby(["league_name", "team_long_name"]).team_api_id.nunique().reset_index()
team_api_id_grouped_count[team_api_id_grouped_count.team_api_id != 1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>league_name</th>
      <th>team_long_name</th>
      <th>team_api_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15</th>
      <td>Belgium Jupiler League</td>
      <td>Royal Excel Mouscron</td>
      <td>2</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Poland Ekstraklasa</td>
      <td>Polonia Bytom</td>
      <td>2</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Poland Ekstraklasa</td>
      <td>Widzew Łódź</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>



- Each of the 3 teams has 2 different team_api_id. Let's use only one of the two team_api_id


```python
df_team.loc[df_team.team_long_name == "Royal Excel Mouscron", "team_api_id"] = 9996 # 274581 -> 9996
df_team.loc[df_team.team_long_name == "Polonia Bytom", "team_api_id"] = 8020 # 8031 -> 8020
df_team.loc[df_team.team_long_name == "Widzew Łódź", "team_api_id"] = 8024 # 8244 -> 8024

df_team = df_team.drop_duplicates()
```


```python
team_api_id_grouped_count = df_team.groupby(["league_name", "team_long_name"]).team_api_id.nunique().reset_index()
team_api_id_grouped_count[team_api_id_grouped_count.team_api_id != 1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>league_name</th>
      <th>team_long_name</th>
      <th>team_api_id</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



- Now, all team has only one team_api_id.
- Save the changed df_team table.


```python
df_team.to_csv("../data/df_team.csv", index = False)
```

- Also, fix the above team_api_ids in the all other tables.


```python
df_match_basic.loc[df_match_basic.home_team_api_id == 274581, "home_team_api_id"] = 9996
df_match_basic.loc[df_match_basic.away_team_api_id == 274581, "away_team_api_id"] = 9996

df_match_basic.loc[df_match_basic.home_team_api_id == 8031, "home_team_api_id"] = 8020
df_match_basic.loc[df_match_basic.away_team_api_id == 8031, "away_team_api_id"] = 8020

df_match_basic.loc[df_match_basic.home_team_api_id == 8244, "home_team_api_id"] = 8024
df_match_basic.loc[df_match_basic.away_team_api_id == 8244, "away_team_api_id"] = 8024

df_match_basic.to_csv("../data/df_match_basic.csv", index = False)
```


```python
df_match_ingame_cross.loc[df_match_ingame_cross.team_api_id == 274581, "team_api_id"] = 9996
df_match_ingame_cross.loc[df_match_ingame_cross.team_api_id == 8031, "team_api_id"] = 8020
df_match_ingame_cross.loc[df_match_ingame_cross.team_api_id == 8244, "team_api_id"] = 8024

df_match_ingame_cross.to_csv("../data/df_match_ingame_cross.csv", index = False)
```


```python
df_match_ingame_foul.loc[df_match_ingame_foul.team_api_id == 274581, "team_api_id"] = 9996
df_match_ingame_foul.loc[df_match_ingame_foul.team_api_id == 8031, "team_api_id"] = 8020
df_match_ingame_foul.loc[df_match_ingame_foul.team_api_id == 8244, "team_api_id"] = 8024

df_match_ingame_foul.to_csv("../data/df_match_ingame_foul.csv", index = False)
```


```python
df_match_ingame_possesion.loc[df_match_ingame_possesion.home_team_api_id == 274581, "home_team_api_id"] = 9996
df_match_ingame_possesion.loc[df_match_ingame_possesion.away_team_api_id == 274581, "away_team_api_id"] = 9996

df_match_ingame_possesion.loc[df_match_ingame_possesion.home_team_api_id == 8031, "home_team_api_id"] = 8020
df_match_ingame_possesion.loc[df_match_ingame_possesion.away_team_api_id == 8031, "away_team_api_id"] = 8020

df_match_ingame_possesion.loc[df_match_ingame_possesion.home_team_api_id == 8244, "home_team_api_id"] = 8024
df_match_ingame_possesion.loc[df_match_ingame_possesion.away_team_api_id == 8244, "away_team_api_id"] = 8024

df_match_ingame_possesion.to_csv("../data/df_match_ingame_possesion.csv", index = False)
```


```python
df_match_ingame_shot.loc[df_match_ingame_shot.team_api_id == 274581, "team_api_id"] = 9996
df_match_ingame_shot.loc[df_match_ingame_shot.team_api_id == 8031, "team_api_id"] = 8020
df_match_ingame_shot.loc[df_match_ingame_shot.team_api_id == 8244, "team_api_id"] = 8024

df_match_ingame_shot.to_csv("../data/df_match_ingame_shot.csv", index = False)
```

## <font color="magenta">3.6. Summary</font>

![df_team_summary](/assets/images/projects/european_soccer_prediction/df_team_summary.png)

# <font color="magenta">4. Overall Summary</font>

![df_overall_summary](/assets/images/projects/european_soccer_prediction/df_overall_summary.png)

- <font color="magenta">**Note**: Team attributes are important features, so I think matches of teams without team attributes from the df_team should be excluded from the analysis later. </font> 


