---
layout: single
title: "2 - 5) EDA - Player information"
permalink: /projects/european_soccer_prediction/2.8.eda_player/
comments: false
author_profile: true
read_time: true
toc: true
toc_label: "Table of Contents"
toc_sticky: true
categories: ["european_soccer_prediction"]
---

```python
import numpy as np 
import pandas as pd 

import matplotlib.pyplot as plt 
import seaborn as sns 
import missingno as msno 
from utils import my_histogram, pca_results

from sklearn.experimental import enable_iterative_imputer
from sklearn.impute import IterativeImputer

from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler, OneHotEncoder
from sklearn.decomposition import PCA
```


    ---------------------------------------------------------------------------

    ImportError                               Traceback (most recent call last)

    Cell In[50], line 7
          5 import seaborn as sns 
          6 import missingno as msno 
    ----> 7 from utils import my_histogram, pca_results
          9 from sklearn.experimental import enable_iterative_imputer
         10 from sklearn.impute import IterativeImputer


    ImportError: cannot import name 'pca_results' from 'utils' (/Users/youngjun/Jun/projects/european_soccer_match_prediction/src/utils.py)



```python
import warnings
warnings.filterwarnings('ignore')
```


```python
pd.set_option('display.max_columns', None)
```


```python
df_player = pd.read_csv("../data/df_player.csv")
df_player
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_name</th>
      <th>birthday</th>
      <th>height</th>
      <th>weight</th>
      <th>player_measured_date</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>preferred_foot</th>
      <th>attacking_work_rate</th>
      <th>defensive_work_rate</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
      <th>position_X_mode</th>
      <th>position_Y_mode</th>
      <th>position_role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2016-02-18</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>defender</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-11-19</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>defender</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-09-21</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>defender</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2015-03-20</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>defender</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>Aaron Appindangoye</td>
      <td>1992-02-29</td>
      <td>182.88</td>
      <td>187</td>
      <td>2007-02-22</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>right</td>
      <td>medium</td>
      <td>medium</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>defender</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183973</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2009-08-30</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>59.0</td>
      <td>89.0</td>
      <td>77.0</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>78.0</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>81.0</td>
      <td>56.0</td>
      <td>78.0</td>
      <td>86.0</td>
      <td>88.0</td>
      <td>83.0</td>
      <td>22.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>forward</td>
    </tr>
    <tr>
      <th>183974</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2009-02-22</td>
      <td>78.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>76.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>forward</td>
    </tr>
    <tr>
      <th>183975</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2008-08-30</td>
      <td>77.0</td>
      <td>80.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>forward</td>
    </tr>
    <tr>
      <th>183976</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2007-08-30</td>
      <td>78.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>57.0</td>
      <td>86.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>61.0</td>
      <td>60.0</td>
      <td>77.0</td>
      <td>69.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>forward</td>
    </tr>
    <tr>
      <th>183977</th>
      <td>39902</td>
      <td>Zvjezdan Misimovic</td>
      <td>1982-06-05</td>
      <td>180.34</td>
      <td>176</td>
      <td>2007-02-22</td>
      <td>80.0</td>
      <td>81.0</td>
      <td>right</td>
      <td>medium</td>
      <td>low</td>
      <td>74.0</td>
      <td>68.0</td>
      <td>57.0</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>53.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>38.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>forward</td>
    </tr>
  </tbody>
</table>
<p>183978 rows × 47 columns</p>
</div>




```python
player_num_attr = ["player_api_id", "player_measured_date", "height", "weight",
                   'overall_rating', 'potential', 'crossing', 'finishing', 'heading_accuracy',
                   'short_passing', 'volleys', 'dribbling', 'curve', 'free_kick_accuracy',
                   'long_passing', 'ball_control', 'acceleration', 'sprint_speed', 'agility', 
                   'reactions', 'balance', 'shot_power', 'jumping', 'stamina',
                   'strength', 'long_shots', 'aggression', 'interceptions', 'positioning',
                   'vision', 'penalties', 'marking', 'standing_tackle', 'sliding_tackle',
                   'gk_diving', 'gk_handling', 'gk_kicking', 'gk_positioning','gk_reflexes']
```


```python
df_player_num_attr = df_player[player_num_attr]
```

# 1. Missing values


```python
msno.matrix(df_player_num_attr)
```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_7_1.png)
    


- If overall_rating is missing, all other attributes are also msissing.


```python
df_player_num_attr.overall_rating.isna().sum()
```




    836



- There are only 836 cases that overall_rating and all other attributes are missing.


```python
len(df_player_num_attr[~df_player_num_attr.overall_rating.isna()].player_api_id.unique())
```




    11060



- Also, even if we drop the cases that overall_rating is missing, we can check that each player's attributes have been measured at least once.
- So let's just drop the cases that overall_rating is missing.


```python
df_player_num_attr = df_player_num_attr[~df_player_num_attr.overall_rating.isna()]
```


```python
msno.matrix(df_player_num_attr.sort_values(["player_api_id", "player_measured_date"]))
```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_14_1.png)
    



```python
df_player_num_attr.isna().sum()[df_player_num_attr.isna().sum() > 0]
```




    volleys           1877
    curve             1877
    agility           1877
    balance           1877
    jumping           1877
    vision            1877
    sliding_tackle    1877
    dtype: int64



- There are some missing values in voleys, curve, agility, balance, jumping, vision, sliding_tackle variables.
- Let's check the correlation between attributes to check whether missing values ​​can be imputed by other variables.


```python
plt.figure(figsize = (20, 5))

corr = round(df_player_num_attr[player_num_attr].corr(), 1)
corr = corr.loc[["volleys", "curve", "agility", "balance", "jumping", "vision", "sliding_tackle"], :]

sns.heatmap(corr, annot = True, cmap = "BrBG", vmin = -1, vmax = 1, 
            linewidths = 0.5, cbar_kws = {"shrink" : 0.5})

```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_17_1.png)
    


- We can see that there are absolute correlations over 0.7 between:
    - volleys: finishing, dribbling, curve, positioning, long_shots, dribbling, positioning, curve, ball_control, shot_power,
                                         penalties
    - curve: dribbling, long_shots, crossing, ball_control, free_kick_accuracy, volleys, short_passing, vision, positioning
    - agility: acceleration, sprint_speed, dribbling
    - balance: agility, height
    - jumping: none
    - vision: ball_control, short_passing, positioning, dribbling, long_shots, curve, free_kick_accuracy, crossing, 
              volleys, long_passing, penalties, finishing
    - sliding_tackle: standing_tackle, marking, interceptions, aggression

- There are plenty of other variables that have high correlation with the variables that have the missing values, except for the balance and jumping.
- So, it seems to be possible to use the iterative imputation for the missing values from the player attributes, except for the balance and jumping.

- However, since only 1%(1877 / 183142) of the data have missing values in banace and jumping columns, let's also use the iterative imputation even for the balance and jumping.


```python
target = df_player_num_attr.set_index(["player_api_id", "player_measured_date"])

index = target.index
col_names = target.columns

imp_player_attr = IterativeImputer(max_iter = 10, random_state = 42)
imp_player_attr.fit(target)
df_player_num_attr_imputed = pd.DataFrame(imp_player_attr.transform(target), 
                                          columns = col_names, index = index)

```


```python
msno.matrix(df_player_num_attr_imputed)
```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_22_1.png)
    



```python
df_player_num_attr_imputed = df_player_num_attr_imputed.reset_index()
```


```python
df_player_num_attr_imputed
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_measured_date</th>
      <th>height</th>
      <th>weight</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>2016-02-18</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>2015-11-19</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>2015-09-21</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>2015-03-20</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>2007-02-22</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183137</th>
      <td>39902</td>
      <td>2009-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>59.0</td>
      <td>89.0</td>
      <td>77.0</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>78.0</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>81.0</td>
      <td>56.0</td>
      <td>78.0</td>
      <td>86.0</td>
      <td>88.0</td>
      <td>83.0</td>
      <td>22.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183138</th>
      <td>39902</td>
      <td>2009-02-22</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>78.0</td>
      <td>80.0</td>
      <td>74.0</td>
      <td>76.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183139</th>
      <td>39902</td>
      <td>2008-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>77.0</td>
      <td>80.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183140</th>
      <td>39902</td>
      <td>2007-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>78.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>57.0</td>
      <td>86.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>61.0</td>
      <td>60.0</td>
      <td>77.0</td>
      <td>69.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183141</th>
      <td>39902</td>
      <td>2007-02-22</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>80.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>68.0</td>
      <td>57.0</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>53.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>38.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>7.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
<p>183142 rows × 39 columns</p>
</div>



# 2. Dimension reduction by PCA

- In the match data, we have the information of 22 players id from the each team.
- Since we will merge the player attributes to the match data, there are too many columns: 22 players * 35 attributes = 770 columns.


```python
df_player_grouped_num_attr = df_player_num_attr_imputed.drop(["player_measured_date", "height", "weight"], axis = 1).groupby("player_api_id").mean()
df_player_grouped_num_attr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
    <tr>
      <th>player_api_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2625</th>
      <td>60.142857</td>
      <td>61.142857</td>
      <td>50.142857</td>
      <td>47.285714</td>
      <td>46.285714</td>
      <td>56.500000</td>
      <td>38.000000</td>
      <td>54.142857</td>
      <td>50.000000</td>
      <td>49.928571</td>
      <td>65.571429</td>
      <td>59.142857</td>
      <td>66.857143</td>
      <td>63.285714</td>
      <td>66.428571</td>
      <td>49.714286</td>
      <td>66.214286</td>
      <td>66.714286</td>
      <td>58.714286</td>
      <td>77.285714</td>
      <td>55.785714</td>
      <td>56.857143</td>
      <td>71.285714</td>
      <td>62.071429</td>
      <td>50.357143</td>
      <td>55.285714</td>
      <td>61.928571</td>
      <td>62.928571</td>
      <td>63.857143</td>
      <td>56.571429</td>
      <td>12.428571</td>
      <td>12.857143</td>
      <td>19.071429</td>
      <td>10.357143</td>
      <td>10.428571</td>
    </tr>
    <tr>
      <th>2752</th>
      <td>69.380952</td>
      <td>70.380952</td>
      <td>36.428571</td>
      <td>37.428571</td>
      <td>75.333333</td>
      <td>54.809524</td>
      <td>20.428571</td>
      <td>44.857143</td>
      <td>30.428571</td>
      <td>18.857143</td>
      <td>59.571429</td>
      <td>55.571429</td>
      <td>41.619048</td>
      <td>42.190476</td>
      <td>43.333333</td>
      <td>60.857143</td>
      <td>44.571429</td>
      <td>57.428571</td>
      <td>56.523810</td>
      <td>60.904762</td>
      <td>82.238095</td>
      <td>19.571429</td>
      <td>80.285714</td>
      <td>71.428571</td>
      <td>31.428571</td>
      <td>52.428571</td>
      <td>35.428571</td>
      <td>71.095238</td>
      <td>70.666667</td>
      <td>65.571429</td>
      <td>11.095238</td>
      <td>6.095238</td>
      <td>7.095238</td>
      <td>9.095238</td>
      <td>15.095238</td>
    </tr>
    <tr>
      <th>2768</th>
      <td>69.285714</td>
      <td>70.571429</td>
      <td>42.238095</td>
      <td>42.761905</td>
      <td>66.666667</td>
      <td>64.714286</td>
      <td>28.761905</td>
      <td>40.238095</td>
      <td>51.761905</td>
      <td>20.047619</td>
      <td>57.000000</td>
      <td>56.380952</td>
      <td>56.952381</td>
      <td>58.904762</td>
      <td>58.047619</td>
      <td>69.809524</td>
      <td>60.190476</td>
      <td>38.761905</td>
      <td>76.904762</td>
      <td>59.285714</td>
      <td>67.428571</td>
      <td>19.428571</td>
      <td>62.761905</td>
      <td>74.714286</td>
      <td>44.190476</td>
      <td>57.761905</td>
      <td>31.904762</td>
      <td>71.666667</td>
      <td>70.619048</td>
      <td>79.714286</td>
      <td>10.761905</td>
      <td>15.904762</td>
      <td>22.714286</td>
      <td>15.142857</td>
      <td>12.095238</td>
    </tr>
    <tr>
      <th>2770</th>
      <td>71.133333</td>
      <td>73.533333</td>
      <td>61.866667</td>
      <td>67.666667</td>
      <td>67.800000</td>
      <td>72.533333</td>
      <td>67.133333</td>
      <td>75.066667</td>
      <td>79.800000</td>
      <td>68.666667</td>
      <td>70.266667</td>
      <td>76.733333</td>
      <td>62.200000</td>
      <td>59.800000</td>
      <td>62.600000</td>
      <td>65.933333</td>
      <td>61.266667</td>
      <td>68.333333</td>
      <td>57.133333</td>
      <td>51.000000</td>
      <td>62.600000</td>
      <td>73.000000</td>
      <td>56.800000</td>
      <td>44.933333</td>
      <td>64.533333</td>
      <td>71.600000</td>
      <td>63.933333</td>
      <td>30.200000</td>
      <td>37.533333</td>
      <td>25.000000</td>
      <td>8.666667</td>
      <td>15.666667</td>
      <td>27.200000</td>
      <td>16.333333</td>
      <td>17.000000</td>
    </tr>
    <tr>
      <th>2790</th>
      <td>70.200000</td>
      <td>75.800000</td>
      <td>70.000000</td>
      <td>37.400000</td>
      <td>55.200000</td>
      <td>68.000000</td>
      <td>43.000000</td>
      <td>60.800000</td>
      <td>67.000000</td>
      <td>55.400000</td>
      <td>69.800000</td>
      <td>66.800000</td>
      <td>70.800000</td>
      <td>71.200000</td>
      <td>65.000000</td>
      <td>69.200000</td>
      <td>67.000000</td>
      <td>46.400000</td>
      <td>61.000000</td>
      <td>70.400000</td>
      <td>71.000000</td>
      <td>42.400000</td>
      <td>68.400000</td>
      <td>63.400000</td>
      <td>60.600000</td>
      <td>60.000000</td>
      <td>55.400000</td>
      <td>74.600000</td>
      <td>74.600000</td>
      <td>69.000000</td>
      <td>8.000000</td>
      <td>17.000000</td>
      <td>59.000000</td>
      <td>16.600000</td>
      <td>17.400000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>744907</th>
      <td>51.909091</td>
      <td>65.909091</td>
      <td>42.454545</td>
      <td>44.454545</td>
      <td>47.454545</td>
      <td>59.454545</td>
      <td>42.454545</td>
      <td>56.454545</td>
      <td>46.454545</td>
      <td>43.454545</td>
      <td>58.454545</td>
      <td>55.454545</td>
      <td>66.000000</td>
      <td>64.000000</td>
      <td>61.000000</td>
      <td>53.454545</td>
      <td>74.000000</td>
      <td>50.454545</td>
      <td>63.000000</td>
      <td>54.000000</td>
      <td>49.909091</td>
      <td>38.454545</td>
      <td>36.454545</td>
      <td>22.454545</td>
      <td>48.454545</td>
      <td>51.454545</td>
      <td>52.454545</td>
      <td>39.454545</td>
      <td>48.454545</td>
      <td>49.454545</td>
      <td>8.454545</td>
      <td>13.454545</td>
      <td>12.454545</td>
      <td>11.454545</td>
      <td>8.454545</td>
    </tr>
    <tr>
      <th>746419</th>
      <td>59.000000</td>
      <td>66.000000</td>
      <td>55.000000</td>
      <td>28.000000</td>
      <td>50.000000</td>
      <td>35.000000</td>
      <td>29.000000</td>
      <td>67.000000</td>
      <td>37.000000</td>
      <td>39.000000</td>
      <td>35.000000</td>
      <td>55.000000</td>
      <td>77.000000</td>
      <td>76.000000</td>
      <td>70.000000</td>
      <td>60.000000</td>
      <td>74.000000</td>
      <td>29.000000</td>
      <td>55.000000</td>
      <td>63.000000</td>
      <td>46.000000</td>
      <td>27.000000</td>
      <td>59.000000</td>
      <td>53.000000</td>
      <td>55.000000</td>
      <td>40.000000</td>
      <td>43.000000</td>
      <td>55.000000</td>
      <td>69.000000</td>
      <td>62.000000</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>7.000000</td>
      <td>9.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>748432</th>
      <td>58.000000</td>
      <td>68.000000</td>
      <td>48.000000</td>
      <td>26.000000</td>
      <td>57.000000</td>
      <td>49.000000</td>
      <td>24.000000</td>
      <td>41.000000</td>
      <td>39.000000</td>
      <td>20.000000</td>
      <td>41.000000</td>
      <td>42.000000</td>
      <td>64.000000</td>
      <td>68.000000</td>
      <td>50.000000</td>
      <td>48.000000</td>
      <td>52.000000</td>
      <td>46.000000</td>
      <td>68.000000</td>
      <td>50.000000</td>
      <td>67.000000</td>
      <td>25.000000</td>
      <td>52.000000</td>
      <td>55.000000</td>
      <td>38.000000</td>
      <td>36.000000</td>
      <td>45.000000</td>
      <td>63.000000</td>
      <td>69.000000</td>
      <td>68.000000</td>
      <td>8.000000</td>
      <td>8.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>750435</th>
      <td>56.444444</td>
      <td>70.444444</td>
      <td>35.000000</td>
      <td>57.000000</td>
      <td>55.000000</td>
      <td>60.000000</td>
      <td>52.000000</td>
      <td>58.555556</td>
      <td>56.000000</td>
      <td>37.000000</td>
      <td>54.000000</td>
      <td>56.333333</td>
      <td>65.666667</td>
      <td>63.555556</td>
      <td>60.222222</td>
      <td>61.000000</td>
      <td>78.000000</td>
      <td>57.000000</td>
      <td>58.000000</td>
      <td>57.000000</td>
      <td>46.000000</td>
      <td>50.000000</td>
      <td>34.000000</td>
      <td>13.000000</td>
      <td>56.333333</td>
      <td>58.000000</td>
      <td>61.000000</td>
      <td>18.000000</td>
      <td>19.000000</td>
      <td>21.000000</td>
      <td>9.000000</td>
      <td>10.000000</td>
      <td>8.000000</td>
      <td>10.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>750584</th>
      <td>58.000000</td>
      <td>66.000000</td>
      <td>47.000000</td>
      <td>39.000000</td>
      <td>53.000000</td>
      <td>60.000000</td>
      <td>37.000000</td>
      <td>54.000000</td>
      <td>40.000000</td>
      <td>45.000000</td>
      <td>55.000000</td>
      <td>56.000000</td>
      <td>63.000000</td>
      <td>60.000000</td>
      <td>51.000000</td>
      <td>54.000000</td>
      <td>76.000000</td>
      <td>59.000000</td>
      <td>58.000000</td>
      <td>55.000000</td>
      <td>57.000000</td>
      <td>38.000000</td>
      <td>62.000000</td>
      <td>56.000000</td>
      <td>41.000000</td>
      <td>47.000000</td>
      <td>52.000000</td>
      <td>56.000000</td>
      <td>66.000000</td>
      <td>62.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>13.000000</td>
      <td>11.000000</td>
      <td>13.000000</td>
    </tr>
  </tbody>
</table>
<p>11060 rows × 35 columns</p>
</div>




```python
plt.figure(figsize = (20, 20))

corr = round(df_player_grouped_num_attr.corr(), 1)

sns.heatmap(corr, annot = True, cmap = "BrBG", vmin = -1, vmax = 1, 
            linewidths = 0.5, cbar_kws = {"shrink" : 0.5})
```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_28_1.png)
    


- Aslo, correlations between player numerical attributes are very high.
- So, I will use the PCA to reduce the dimension of the numerical player attributes.

- Note that we set the the last season (2015/2016 seasons) as the test set.
- So we will fit the PCA to the only train data and transform all data by fitted PC loadings.

- Check the season start month to exclude the player attributes information measured before the 2015 season.


```python
df_match_basic = pd.read_csv("../data/df_match_basic.csv")
```


```python
for season in ["2015/2016"]:
    print(f"== Season: {season}")
    print(df_match_basic[df_match_basic.season == season].sort_values("match_date").groupby(["league_id", "season"]).min().match_date)
```

    == Season: 2015/2016
    league_id  season   
    1          2015/2016    2015-07-24
    1729       2015/2016    2015-08-08
    4769       2015/2016    2015-08-07
    7809       2015/2016    2015-08-14
    10257      2015/2016    2015-08-22
    13274      2015/2016    2015-08-08
    15722      2015/2016    2015-07-17
    17642      2015/2016    2015-08-14
    19694      2015/2016    2015-08-01
    21518      2015/2016    2015-08-21
    24558      2015/2016    2015-07-18
    Name: match_date, dtype: object


- We can use the player attributes information measured before the 2015-07-17


```python
player_cutoff_date = pd.to_datetime("2015-07-17")
player_cutoff_date
```




    Timestamp('2015-07-17 00:00:00')




```python
df_player_num_attr_imputed
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_measured_date</th>
      <th>height</th>
      <th>weight</th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>2016-02-18</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>2015-11-19</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>67.0</td>
      <td>71.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>71.0</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>2015-09-21</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>62.0</td>
      <td>66.0</td>
      <td>49.0</td>
      <td>44.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>44.0</td>
      <td>51.0</td>
      <td>45.0</td>
      <td>39.0</td>
      <td>64.0</td>
      <td>49.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>47.0</td>
      <td>65.0</td>
      <td>55.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>35.0</td>
      <td>63.0</td>
      <td>41.0</td>
      <td>45.0</td>
      <td>54.0</td>
      <td>48.0</td>
      <td>65.0</td>
      <td>66.0</td>
      <td>69.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>2015-03-20</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>2007-02-22</td>
      <td>182.88</td>
      <td>187.0</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>48.0</td>
      <td>43.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>44.0</td>
      <td>38.0</td>
      <td>63.0</td>
      <td>48.0</td>
      <td>60.0</td>
      <td>64.0</td>
      <td>59.0</td>
      <td>46.0</td>
      <td>65.0</td>
      <td>54.0</td>
      <td>58.0</td>
      <td>54.0</td>
      <td>76.0</td>
      <td>34.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>44.0</td>
      <td>53.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>66.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183137</th>
      <td>39902</td>
      <td>2009-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>59.0</td>
      <td>89.0</td>
      <td>77.0</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>78.0</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>66.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>76.0</td>
      <td>58.0</td>
      <td>72.0</td>
      <td>67.0</td>
      <td>81.0</td>
      <td>56.0</td>
      <td>78.0</td>
      <td>86.0</td>
      <td>88.0</td>
      <td>83.0</td>
      <td>22.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>84.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183138</th>
      <td>39902</td>
      <td>2009-02-22</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>78.0</td>
      <td>80.0</td>
      <td>74.0</td>
      <td>76.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183139</th>
      <td>39902</td>
      <td>2008-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>77.0</td>
      <td>80.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>53.0</td>
      <td>84.0</td>
      <td>77.0</td>
      <td>85.0</td>
      <td>86.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>73.0</td>
      <td>75.0</td>
      <td>58.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>73.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>72.0</td>
      <td>88.0</td>
      <td>70.0</td>
      <td>32.0</td>
      <td>31.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183140</th>
      <td>39902</td>
      <td>2007-08-30</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>78.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>57.0</td>
      <td>86.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>73.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>61.0</td>
      <td>60.0</td>
      <td>77.0</td>
      <td>69.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>20.0</td>
      <td>73.0</td>
      <td>20.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>183141</th>
      <td>39902</td>
      <td>2007-02-22</td>
      <td>180.34</td>
      <td>176.0</td>
      <td>80.0</td>
      <td>81.0</td>
      <td>74.0</td>
      <td>68.0</td>
      <td>57.0</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>86.0</td>
      <td>53.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>73.0</td>
      <td>72.0</td>
      <td>58.0</td>
      <td>67.0</td>
      <td>59.0</td>
      <td>78.0</td>
      <td>63.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>53.0</td>
      <td>38.0</td>
      <td>32.0</td>
      <td>30.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>78.0</td>
      <td>7.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
<p>183142 rows × 39 columns</p>
</div>




```python
player_cutoff_bool = pd.to_datetime(df_player_num_attr_imputed.player_measured_date) < player_cutoff_date
```


```python
df_player_grouped_num_attr = df_player_num_attr_imputed.drop(["player_measured_date", "height", "weight"], axis = 1)[player_cutoff_bool].groupby("player_api_id").mean()
df_player_grouped_num_attr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>overall_rating</th>
      <th>potential</th>
      <th>crossing</th>
      <th>finishing</th>
      <th>heading_accuracy</th>
      <th>short_passing</th>
      <th>volleys</th>
      <th>dribbling</th>
      <th>curve</th>
      <th>free_kick_accuracy</th>
      <th>long_passing</th>
      <th>ball_control</th>
      <th>acceleration</th>
      <th>sprint_speed</th>
      <th>agility</th>
      <th>reactions</th>
      <th>balance</th>
      <th>shot_power</th>
      <th>jumping</th>
      <th>stamina</th>
      <th>strength</th>
      <th>long_shots</th>
      <th>aggression</th>
      <th>interceptions</th>
      <th>positioning</th>
      <th>vision</th>
      <th>penalties</th>
      <th>marking</th>
      <th>standing_tackle</th>
      <th>sliding_tackle</th>
      <th>gk_diving</th>
      <th>gk_handling</th>
      <th>gk_kicking</th>
      <th>gk_positioning</th>
      <th>gk_reflexes</th>
    </tr>
    <tr>
      <th>player_api_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2625</th>
      <td>60.142857</td>
      <td>61.142857</td>
      <td>50.142857</td>
      <td>47.285714</td>
      <td>46.285714</td>
      <td>56.500000</td>
      <td>38.000000</td>
      <td>54.142857</td>
      <td>50.000000</td>
      <td>49.928571</td>
      <td>65.571429</td>
      <td>59.142857</td>
      <td>66.857143</td>
      <td>63.285714</td>
      <td>66.428571</td>
      <td>49.714286</td>
      <td>66.214286</td>
      <td>66.714286</td>
      <td>58.714286</td>
      <td>77.285714</td>
      <td>55.785714</td>
      <td>56.857143</td>
      <td>71.285714</td>
      <td>62.071429</td>
      <td>50.357143</td>
      <td>55.285714</td>
      <td>61.928571</td>
      <td>62.928571</td>
      <td>63.857143</td>
      <td>56.571429</td>
      <td>12.428571</td>
      <td>12.857143</td>
      <td>19.071429</td>
      <td>10.357143</td>
      <td>10.428571</td>
    </tr>
    <tr>
      <th>2752</th>
      <td>69.105263</td>
      <td>70.210526</td>
      <td>36.157895</td>
      <td>37.157895</td>
      <td>74.631579</td>
      <td>54.368421</td>
      <td>20.157895</td>
      <td>45.263158</td>
      <td>30.157895</td>
      <td>18.842105</td>
      <td>59.421053</td>
      <td>55.421053</td>
      <td>42.578947</td>
      <td>42.526316</td>
      <td>44.315789</td>
      <td>60.526316</td>
      <td>45.157895</td>
      <td>57.157895</td>
      <td>56.684211</td>
      <td>60.789474</td>
      <td>81.947368</td>
      <td>19.526316</td>
      <td>79.894737</td>
      <td>71.473684</td>
      <td>31.157895</td>
      <td>52.157895</td>
      <td>35.157895</td>
      <td>71.000000</td>
      <td>70.315789</td>
      <td>65.421053</td>
      <td>11.000000</td>
      <td>6.000000</td>
      <td>7.000000</td>
      <td>9.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>2768</th>
      <td>67.562500</td>
      <td>69.250000</td>
      <td>41.687500</td>
      <td>42.062500</td>
      <td>65.000000</td>
      <td>61.562500</td>
      <td>28.062500</td>
      <td>39.062500</td>
      <td>52.312500</td>
      <td>19.437500</td>
      <td>56.062500</td>
      <td>54.312500</td>
      <td>58.687500</td>
      <td>60.687500</td>
      <td>58.062500</td>
      <td>67.562500</td>
      <td>59.937500</td>
      <td>38.062500</td>
      <td>76.250000</td>
      <td>64.000000</td>
      <td>66.000000</td>
      <td>19.250000</td>
      <td>62.062500</td>
      <td>72.812500</td>
      <td>45.500000</td>
      <td>57.062500</td>
      <td>36.875000</td>
      <td>69.812500</td>
      <td>68.687500</td>
      <td>80.062500</td>
      <td>10.375000</td>
      <td>16.187500</td>
      <td>25.750000</td>
      <td>15.500000</td>
      <td>12.750000</td>
    </tr>
    <tr>
      <th>2770</th>
      <td>71.133333</td>
      <td>73.533333</td>
      <td>61.866667</td>
      <td>67.666667</td>
      <td>67.800000</td>
      <td>72.533333</td>
      <td>67.133333</td>
      <td>75.066667</td>
      <td>79.800000</td>
      <td>68.666667</td>
      <td>70.266667</td>
      <td>76.733333</td>
      <td>62.200000</td>
      <td>59.800000</td>
      <td>62.600000</td>
      <td>65.933333</td>
      <td>61.266667</td>
      <td>68.333333</td>
      <td>57.133333</td>
      <td>51.000000</td>
      <td>62.600000</td>
      <td>73.000000</td>
      <td>56.800000</td>
      <td>44.933333</td>
      <td>64.533333</td>
      <td>71.600000</td>
      <td>63.933333</td>
      <td>30.200000</td>
      <td>37.533333</td>
      <td>25.000000</td>
      <td>8.666667</td>
      <td>15.666667</td>
      <td>27.200000</td>
      <td>16.333333</td>
      <td>17.000000</td>
    </tr>
    <tr>
      <th>2790</th>
      <td>70.200000</td>
      <td>75.800000</td>
      <td>70.000000</td>
      <td>37.400000</td>
      <td>55.200000</td>
      <td>68.000000</td>
      <td>43.000000</td>
      <td>60.800000</td>
      <td>67.000000</td>
      <td>55.400000</td>
      <td>69.800000</td>
      <td>66.800000</td>
      <td>70.800000</td>
      <td>71.200000</td>
      <td>65.000000</td>
      <td>69.200000</td>
      <td>67.000000</td>
      <td>46.400000</td>
      <td>61.000000</td>
      <td>70.400000</td>
      <td>71.000000</td>
      <td>42.400000</td>
      <td>68.400000</td>
      <td>63.400000</td>
      <td>60.600000</td>
      <td>60.000000</td>
      <td>55.400000</td>
      <td>74.600000</td>
      <td>74.600000</td>
      <td>69.000000</td>
      <td>8.000000</td>
      <td>17.000000</td>
      <td>59.000000</td>
      <td>16.600000</td>
      <td>17.400000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>744907</th>
      <td>51.000000</td>
      <td>65.000000</td>
      <td>42.000000</td>
      <td>44.000000</td>
      <td>47.000000</td>
      <td>59.000000</td>
      <td>42.000000</td>
      <td>56.000000</td>
      <td>46.000000</td>
      <td>43.000000</td>
      <td>58.000000</td>
      <td>55.000000</td>
      <td>66.000000</td>
      <td>64.000000</td>
      <td>61.000000</td>
      <td>53.000000</td>
      <td>74.000000</td>
      <td>50.000000</td>
      <td>63.000000</td>
      <td>54.000000</td>
      <td>49.000000</td>
      <td>38.000000</td>
      <td>36.000000</td>
      <td>22.000000</td>
      <td>48.000000</td>
      <td>51.000000</td>
      <td>52.000000</td>
      <td>39.000000</td>
      <td>48.000000</td>
      <td>49.000000</td>
      <td>8.000000</td>
      <td>13.000000</td>
      <td>12.000000</td>
      <td>11.000000</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>746419</th>
      <td>59.000000</td>
      <td>66.000000</td>
      <td>55.000000</td>
      <td>28.000000</td>
      <td>50.000000</td>
      <td>35.000000</td>
      <td>29.000000</td>
      <td>67.000000</td>
      <td>37.000000</td>
      <td>39.000000</td>
      <td>35.000000</td>
      <td>55.000000</td>
      <td>77.000000</td>
      <td>76.000000</td>
      <td>70.000000</td>
      <td>60.000000</td>
      <td>74.000000</td>
      <td>29.000000</td>
      <td>55.000000</td>
      <td>63.000000</td>
      <td>46.000000</td>
      <td>27.000000</td>
      <td>59.000000</td>
      <td>53.000000</td>
      <td>55.000000</td>
      <td>40.000000</td>
      <td>43.000000</td>
      <td>55.000000</td>
      <td>69.000000</td>
      <td>62.000000</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>7.000000</td>
      <td>9.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>748432</th>
      <td>58.000000</td>
      <td>68.000000</td>
      <td>48.000000</td>
      <td>26.000000</td>
      <td>57.000000</td>
      <td>49.000000</td>
      <td>24.000000</td>
      <td>41.000000</td>
      <td>39.000000</td>
      <td>20.000000</td>
      <td>41.000000</td>
      <td>42.000000</td>
      <td>64.000000</td>
      <td>68.000000</td>
      <td>50.000000</td>
      <td>48.000000</td>
      <td>52.000000</td>
      <td>46.000000</td>
      <td>68.000000</td>
      <td>50.000000</td>
      <td>67.000000</td>
      <td>25.000000</td>
      <td>52.000000</td>
      <td>55.000000</td>
      <td>38.000000</td>
      <td>36.000000</td>
      <td>45.000000</td>
      <td>63.000000</td>
      <td>69.000000</td>
      <td>68.000000</td>
      <td>8.000000</td>
      <td>8.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>750435</th>
      <td>56.000000</td>
      <td>70.000000</td>
      <td>35.000000</td>
      <td>57.000000</td>
      <td>55.000000</td>
      <td>60.000000</td>
      <td>52.000000</td>
      <td>58.000000</td>
      <td>56.000000</td>
      <td>37.000000</td>
      <td>54.000000</td>
      <td>56.000000</td>
      <td>64.000000</td>
      <td>62.000000</td>
      <td>55.600000</td>
      <td>61.000000</td>
      <td>78.000000</td>
      <td>57.000000</td>
      <td>58.000000</td>
      <td>57.000000</td>
      <td>46.000000</td>
      <td>50.000000</td>
      <td>34.000000</td>
      <td>13.000000</td>
      <td>56.000000</td>
      <td>58.000000</td>
      <td>61.000000</td>
      <td>18.000000</td>
      <td>19.000000</td>
      <td>21.000000</td>
      <td>9.000000</td>
      <td>10.000000</td>
      <td>8.000000</td>
      <td>10.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>750584</th>
      <td>58.000000</td>
      <td>66.000000</td>
      <td>47.000000</td>
      <td>39.000000</td>
      <td>53.000000</td>
      <td>60.000000</td>
      <td>37.000000</td>
      <td>54.000000</td>
      <td>40.000000</td>
      <td>45.000000</td>
      <td>55.000000</td>
      <td>56.000000</td>
      <td>63.000000</td>
      <td>60.000000</td>
      <td>51.000000</td>
      <td>54.000000</td>
      <td>76.000000</td>
      <td>59.000000</td>
      <td>58.000000</td>
      <td>55.000000</td>
      <td>57.000000</td>
      <td>38.000000</td>
      <td>62.000000</td>
      <td>56.000000</td>
      <td>41.000000</td>
      <td>47.000000</td>
      <td>52.000000</td>
      <td>56.000000</td>
      <td>66.000000</td>
      <td>62.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>13.000000</td>
      <td>11.000000</td>
      <td>13.000000</td>
    </tr>
  </tbody>
</table>
<p>11060 rows × 35 columns</p>
</div>




```python
pipe = Pipeline([
    ('scale',StandardScaler()),
    ('pca', PCA(n_components = 10, random_state = 42)),
])
```


```python
res = pipe.fit_transform(df_player_grouped_num_attr)
```


```python
plt.figure(figsize = (14, 8))

plt.bar(range(1,len(pipe.named_steps.pca.explained_variance_ratio_) + 1), pipe.named_steps.pca.explained_variance_ratio_, alpha=0.5, align='center', label='Individual explained variance')
plt.step(range(1,len(np.cumsum(pipe.named_steps.pca.explained_variance_ratio_)) + 1), np.cumsum(pipe.named_steps.pca.explained_variance_ratio_), where='mid',label='Cumulative explained variance')
plt.ylabel('Explained variance ratio', fontsize = 14)
plt.xlabel('Principal component index', fontsize = 14)
plt.legend(loc = 'best')
plt.tight_layout()
plt.show()
```


    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_41_0.png)
    


- 5 variables can explain about 80% of the total variance.
- That is, PCA variables can reduce the number of variables without significant loss of information.

- Let's check 5 PC variables.


```python
pipe = Pipeline([
    ('scale',StandardScaler()),
    ('pca', PCA(n_components = 5, random_state = 42)),
])
```


```python
res = pipe.fit_transform(df_player_grouped_num_attr)
```


```python
_ = pca_results(df_player_grouped_num_attr, pipe.named_steps.pca)

```


    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_46_0.png)
    


- Since our goal is to reduce the numerical attributes variables without significant loss of information, let's just use 5 PC variables for each player.
- So for each match, we reduced from 22 players * 35 attributes = 770 columns to 22 players * 5 PC = 110 columns.


```python
cols = df_player_grouped_num_attr.columns.tolist()
cols.append("player_api_id")
cols.append("player_measured_date")
```


```python
df_player_num_attr_pc  = pipe.fit_transform(df_player_num_attr_imputed[cols].set_index(["player_api_id", "player_measured_date"]))
```


```python
df_player_num_attr_pc = pd.DataFrame(df_player_num_attr_pc, columns = ["PC1", "PC2", "PC3", "PC4", "PC5"], 
                                     index = df_player_num_attr_imputed[cols].set_index(["player_api_id", "player_measured_date"]).index).reset_index()
df_player_num_attr_pc
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_measured_date</th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
      <th>PC4</th>
      <th>PC5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>2016-02-18</td>
      <td>1.046944</td>
      <td>2.688259</td>
      <td>-1.529901</td>
      <td>0.360865</td>
      <td>0.548021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>2015-11-19</td>
      <td>1.046944</td>
      <td>2.688259</td>
      <td>-1.529901</td>
      <td>0.360865</td>
      <td>0.548021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>2015-09-21</td>
      <td>1.400003</td>
      <td>2.036745</td>
      <td>-2.359132</td>
      <td>0.536742</td>
      <td>0.502532</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>2015-03-20</td>
      <td>1.615408</td>
      <td>1.927571</td>
      <td>-2.657865</td>
      <td>0.548879</td>
      <td>0.399693</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>2007-02-22</td>
      <td>1.615408</td>
      <td>1.927571</td>
      <td>-2.657865</td>
      <td>0.548879</td>
      <td>0.399693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183137</th>
      <td>39902</td>
      <td>2009-08-30</td>
      <td>-4.991884</td>
      <td>-2.921361</td>
      <td>4.090605</td>
      <td>0.593824</td>
      <td>2.434563</td>
    </tr>
    <tr>
      <th>183138</th>
      <td>39902</td>
      <td>2009-02-22</td>
      <td>-3.766452</td>
      <td>-2.749777</td>
      <td>2.543465</td>
      <td>0.492997</td>
      <td>2.349990</td>
    </tr>
    <tr>
      <th>183139</th>
      <td>39902</td>
      <td>2008-08-30</td>
      <td>-3.745176</td>
      <td>-2.589656</td>
      <td>2.519182</td>
      <td>0.452451</td>
      <td>2.349129</td>
    </tr>
    <tr>
      <th>183140</th>
      <td>39902</td>
      <td>2007-08-30</td>
      <td>-3.382604</td>
      <td>-2.497503</td>
      <td>2.251858</td>
      <td>0.317332</td>
      <td>2.726097</td>
    </tr>
    <tr>
      <th>183141</th>
      <td>39902</td>
      <td>2007-02-22</td>
      <td>-3.659867</td>
      <td>-2.058531</td>
      <td>1.834322</td>
      <td>0.277823</td>
      <td>2.463788</td>
    </tr>
  </tbody>
</table>
<p>183142 rows × 7 columns</p>
</div>




```python
player_num_collected = pd.DataFrame(df_player_num_attr_pc.groupby("player_api_id").count().player_measured_date)
player_num_collected.columns = ["num_collected"]
player_num_collected
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_collected</th>
    </tr>
    <tr>
      <th>player_api_id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2625</th>
      <td>14</td>
    </tr>
    <tr>
      <th>2752</th>
      <td>21</td>
    </tr>
    <tr>
      <th>2768</th>
      <td>21</td>
    </tr>
    <tr>
      <th>2770</th>
      <td>15</td>
    </tr>
    <tr>
      <th>2790</th>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>744907</th>
      <td>11</td>
    </tr>
    <tr>
      <th>746419</th>
      <td>2</td>
    </tr>
    <tr>
      <th>748432</th>
      <td>2</td>
    </tr>
    <tr>
      <th>750435</th>
      <td>9</td>
    </tr>
    <tr>
      <th>750584</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>11060 rows × 1 columns</p>
</div>




```python
df_player_num_attr_pc.groupby("player_api_id").count().player_measured_date.describe()
```




    count    11060.000000
    mean        16.558951
    std          9.361642
    min          2.000000
    25%          8.000000
    50%         16.000000
    75%         23.000000
    max         56.000000
    Name: player_measured_date, dtype: float64




```python
my_histogram(player_num_collected, "num_collected")
```


    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_53_0.png)
    


- Players' attributes are collected in different days.
- The player's characteristic data was collected 2 times for the fewest players and 56 times for the most players.
- So, we will use player attributes collected closest to match dates.

- Let's merge all starting players' PC variables collected closest to match dates.


```python
df_match_player = pd.read_csv("../data/df_match_player.csv")
```


```python
df_match_basic[["match_api_id", "match_date"]].merge(df_match_player, how = "left", on = "match_api_id")

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>match_date</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>home_player_Y8</th>
      <th>home_player_Y9</th>
      <th>home_player_Y10</th>
      <th>home_player_Y11</th>
      <th>away_player_Y1</th>
      <th>away_player_Y2</th>
      <th>away_player_Y3</th>
      <th>away_player_Y4</th>
      <th>away_player_Y5</th>
      <th>away_player_Y6</th>
      <th>away_player_Y7</th>
      <th>away_player_Y8</th>
      <th>away_player_Y9</th>
      <th>away_player_Y10</th>
      <th>away_player_Y11</th>
      <th>home_player_1</th>
      <th>home_player_2</th>
      <th>home_player_3</th>
      <th>home_player_4</th>
      <th>home_player_5</th>
      <th>home_player_6</th>
      <th>home_player_7</th>
      <th>home_player_8</th>
      <th>home_player_9</th>
      <th>home_player_10</th>
      <th>home_player_11</th>
      <th>away_player_1</th>
      <th>away_player_2</th>
      <th>away_player_3</th>
      <th>away_player_4</th>
      <th>away_player_5</th>
      <th>away_player_6</th>
      <th>away_player_7</th>
      <th>away_player_8</th>
      <th>away_player_9</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>492473</td>
      <td>2008-08-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>492474</td>
      <td>2008-08-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>492475</td>
      <td>2008-08-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>492476</td>
      <td>2008-08-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>492477</td>
      <td>2008-08-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25974</th>
      <td>1992091</td>
      <td>2015-09-22</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>42231.0</td>
      <td>678384.0</td>
      <td>95220.0</td>
      <td>638592.0</td>
      <td>413155.0</td>
      <td>45780.0</td>
      <td>171229.0</td>
      <td>67333.0</td>
      <td>119839.0</td>
      <td>143790.0</td>
      <td>195215.0</td>
      <td>462944.0</td>
      <td>563066.0</td>
      <td>8800.0</td>
      <td>67304.0</td>
      <td>158253.0</td>
      <td>133126.0</td>
      <td>186524.0</td>
      <td>93223.0</td>
      <td>121115.0</td>
      <td>232110.0</td>
      <td>289732.0</td>
    </tr>
    <tr>
      <th>25975</th>
      <td>1992092</td>
      <td>2015-09-23</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>33272.0</td>
      <td>41621.0</td>
      <td>25813.0</td>
      <td>257845.0</td>
      <td>114735.0</td>
      <td>42237.0</td>
      <td>113227.0</td>
      <td>358156.0</td>
      <td>32343.0</td>
      <td>531309.0</td>
      <td>37257.0</td>
      <td>42276.0</td>
      <td>114792.0</td>
      <td>150007.0</td>
      <td>178119.0</td>
      <td>27232.0</td>
      <td>570830.0</td>
      <td>260708.0</td>
      <td>201704.0</td>
      <td>36382.0</td>
      <td>34082.0</td>
      <td>95257.0</td>
    </tr>
    <tr>
      <th>25976</th>
      <td>1992093</td>
      <td>2015-09-23</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>157856.0</td>
      <td>274779.0</td>
      <td>177689.0</td>
      <td>294256.0</td>
      <td>42258.0</td>
      <td>39979.0</td>
      <td>173936.0</td>
      <td>147959.0</td>
      <td>451983.0</td>
      <td>80564.0</td>
      <td>289472.0</td>
      <td>10637.0</td>
      <td>67349.0</td>
      <td>202663.0</td>
      <td>32597.0</td>
      <td>114794.0</td>
      <td>188114.0</td>
      <td>25840.0</td>
      <td>482200.0</td>
      <td>95230.0</td>
      <td>451335.0</td>
      <td>275122.0</td>
    </tr>
    <tr>
      <th>25977</th>
      <td>1992094</td>
      <td>2015-09-22</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>8881.0</td>
      <td>173534.0</td>
      <td>39646.0</td>
      <td>282287.0</td>
      <td>340790.0</td>
      <td>393337.0</td>
      <td>8893.0</td>
      <td>614454.0</td>
      <td>93229.0</td>
      <td>178142.0</td>
      <td>274776.0</td>
      <td>121080.0</td>
      <td>197757.0</td>
      <td>260964.0</td>
      <td>231614.0</td>
      <td>113235.0</td>
      <td>41116.0</td>
      <td>462608.0</td>
      <td>42262.0</td>
      <td>92252.0</td>
      <td>194532.0</td>
    </tr>
    <tr>
      <th>25978</th>
      <td>1992095</td>
      <td>2015-09-23</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>274787.0</td>
      <td>492132.0</td>
      <td>108451.0</td>
      <td>25815.0</td>
      <td>94553.0</td>
      <td>384376.0</td>
      <td>598355.0</td>
      <td>36785.0</td>
      <td>45174.0</td>
      <td>302079.0</td>
      <td>71764.0</td>
      <td>156175.0</td>
      <td>95216.0</td>
      <td>172768.0</td>
      <td>22834.0</td>
      <td>458806.0</td>
      <td>207234.0</td>
      <td>25772.0</td>
      <td>40274.0</td>
      <td>34035.0</td>
      <td>41726.0</td>
      <td>527103.0</td>
    </tr>
  </tbody>
</table>
<p>25979 rows × 68 columns</p>
</div>




```python
df_match_lineup = df_match_basic[["match_api_id", "match_date"]].merge(df_match_player, how = "left", on = "match_api_id") \
                                [["match_date", "match_api_id",
                                  "home_player_1", "home_player_2", "home_player_3", "home_player_4", 
                                  "home_player_5", "home_player_6", "home_player_7", "home_player_8",
                                  "home_player_9", "home_player_10", "home_player_11", 
                                  "away_player_1", "away_player_2", "away_player_3", "away_player_4", 
                                  "away_player_5", "away_player_6", "away_player_7", "away_player_8",
                                  "away_player_9", "away_player_10", "away_player_11"]]
```


```python
msno.matrix(df_match_lineup.sort_values("match_date"))
```




    <AxesSubplot:>




    
![png](/assets/images/projects/european_soccer_prediction/2.8.eda_player_59_1.png)
    


- If there is at least one missing value in the starting lineup, let's exclude the match from the analysis.


```python
df_match_lineup = df_match_lineup.dropna()
```


```python
df_match_lineup.shape
```




    (21374, 24)



- Use the pc variables measured closest to the match date for each player.


```python
df_player_num_attr_pc
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_api_id</th>
      <th>player_measured_date</th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
      <th>PC4</th>
      <th>PC5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>505942</td>
      <td>2016-02-18</td>
      <td>1.046944</td>
      <td>2.688259</td>
      <td>-1.529901</td>
      <td>0.360865</td>
      <td>0.548021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>505942</td>
      <td>2015-11-19</td>
      <td>1.046944</td>
      <td>2.688259</td>
      <td>-1.529901</td>
      <td>0.360865</td>
      <td>0.548021</td>
    </tr>
    <tr>
      <th>2</th>
      <td>505942</td>
      <td>2015-09-21</td>
      <td>1.400003</td>
      <td>2.036745</td>
      <td>-2.359132</td>
      <td>0.536742</td>
      <td>0.502532</td>
    </tr>
    <tr>
      <th>3</th>
      <td>505942</td>
      <td>2015-03-20</td>
      <td>1.615408</td>
      <td>1.927571</td>
      <td>-2.657865</td>
      <td>0.548879</td>
      <td>0.399693</td>
    </tr>
    <tr>
      <th>4</th>
      <td>505942</td>
      <td>2007-02-22</td>
      <td>1.615408</td>
      <td>1.927571</td>
      <td>-2.657865</td>
      <td>0.548879</td>
      <td>0.399693</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>183137</th>
      <td>39902</td>
      <td>2009-08-30</td>
      <td>-4.991884</td>
      <td>-2.921361</td>
      <td>4.090605</td>
      <td>0.593824</td>
      <td>2.434563</td>
    </tr>
    <tr>
      <th>183138</th>
      <td>39902</td>
      <td>2009-02-22</td>
      <td>-3.766452</td>
      <td>-2.749777</td>
      <td>2.543465</td>
      <td>0.492997</td>
      <td>2.349990</td>
    </tr>
    <tr>
      <th>183139</th>
      <td>39902</td>
      <td>2008-08-30</td>
      <td>-3.745176</td>
      <td>-2.589656</td>
      <td>2.519182</td>
      <td>0.452451</td>
      <td>2.349129</td>
    </tr>
    <tr>
      <th>183140</th>
      <td>39902</td>
      <td>2007-08-30</td>
      <td>-3.382604</td>
      <td>-2.497503</td>
      <td>2.251858</td>
      <td>0.317332</td>
      <td>2.726097</td>
    </tr>
    <tr>
      <th>183141</th>
      <td>39902</td>
      <td>2007-02-22</td>
      <td>-3.659867</td>
      <td>-2.058531</td>
      <td>1.834322</td>
      <td>0.277823</td>
      <td>2.463788</td>
    </tr>
  </tbody>
</table>
<p>183142 rows × 7 columns</p>
</div>




```python
df_match_player_attr_pcs = df_match_lineup[["match_api_id"]]
```


```python
for i, col in enumerate(["home_player_1", "home_player_2", "home_player_3", "home_player_4", 
                         "home_player_5", "home_player_6", "home_player_7", "home_player_8",
                         "home_player_9", "home_player_10", "home_player_11"]):
    
        merged = df_match_lineup[["match_date", "match_api_id", col]].merge(df_player_num_attr_pc,
                                                                            how = "left", left_on = col,  right_on = "player_api_id") \
                                                                            .sort_values(["player_api_id", "match_date", "player_measured_date"])      
                                                  
        merged["date_diff"] = (pd.to_datetime(merged.player_measured_date) - pd.to_datetime(merged.match_date)).dt.days
        merged = merged[merged.date_diff < 0]
        merged_get_first = merged.sort_values(["player_api_id", "match_date", "date_diff"], ascending = [True, True, False]).groupby(["player_api_id", "match_date"]).first()
        merged_get_first = merged_get_first[["match_api_id", "PC1", "PC2", "PC3", "PC4", "PC5"]].rename(columns = {"PC1": f"home_player_{i + 1}_pc_1", 
                                                                                                                   "PC2": f"home_player_{i + 1}_pc_2",
                                                                                                                   "PC3": f"home_player_{i + 1}_pc_3",
                                                                                                                   "PC4": f"home_player_{i + 1}_pc_4",
                                                                                                                   "PC5": f"home_player_{i + 1}_pc_5"})
        
        
        df_match_player_attr_pcs = df_match_player_attr_pcs.merge(merged_get_first, how = "left", on = "match_api_id")
```


```python
for i, col in enumerate(["away_player_1", "away_player_2", "away_player_3", "away_player_4", 
                         "away_player_5", "away_player_6", "away_player_7", "away_player_8",
                         "away_player_9", "away_player_10", "away_player_11"]):
    
        merged = df_match_lineup[["match_date", "match_api_id", col]].merge(df_player_num_attr_pc,
                                                                            how = "left", left_on = col,  right_on = "player_api_id") \
                                                                            .sort_values(["player_api_id", "match_date", "player_measured_date"])      
                                                  
        merged["date_diff"] = (pd.to_datetime(merged.player_measured_date) - pd.to_datetime(merged.match_date)).dt.days
        merged = merged[merged.date_diff < 0]
        merged_get_first = merged.sort_values(["player_api_id", "match_date", "date_diff"], ascending = [True, True, False]).groupby(["player_api_id", "match_date"]).first()
        merged_get_first = merged_get_first[["match_api_id", "PC1", "PC2", "PC3", "PC4", "PC5"]].rename(columns = {"PC1": f"away_player_{i + 1}_pc_1", 
                                                                                                                   "PC2": f"away_player_{i + 1}_pc_2",
                                                                                                                   "PC3": f"away_player_{i + 1}_pc_3",
                                                                                                                   "PC4": f"away_player_{i + 1}_pc_4",
                                                                                                                   "PC5": f"away_player_{i + 1}_pc_5"})
        
        
        df_match_player_attr_pcs = df_match_player_attr_pcs.merge(merged_get_first, how = "left", on = "match_api_id")
```


```python
df_match_player_attr_pcs
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>match_api_id</th>
      <th>home_player_1_pc_1</th>
      <th>home_player_1_pc_2</th>
      <th>home_player_1_pc_3</th>
      <th>home_player_1_pc_4</th>
      <th>home_player_1_pc_5</th>
      <th>home_player_2_pc_1</th>
      <th>home_player_2_pc_2</th>
      <th>home_player_2_pc_3</th>
      <th>home_player_2_pc_4</th>
      <th>home_player_2_pc_5</th>
      <th>home_player_3_pc_1</th>
      <th>home_player_3_pc_2</th>
      <th>home_player_3_pc_3</th>
      <th>home_player_3_pc_4</th>
      <th>home_player_3_pc_5</th>
      <th>home_player_4_pc_1</th>
      <th>home_player_4_pc_2</th>
      <th>home_player_4_pc_3</th>
      <th>home_player_4_pc_4</th>
      <th>home_player_4_pc_5</th>
      <th>home_player_5_pc_1</th>
      <th>home_player_5_pc_2</th>
      <th>home_player_5_pc_3</th>
      <th>home_player_5_pc_4</th>
      <th>home_player_5_pc_5</th>
      <th>home_player_6_pc_1</th>
      <th>home_player_6_pc_2</th>
      <th>home_player_6_pc_3</th>
      <th>home_player_6_pc_4</th>
      <th>home_player_6_pc_5</th>
      <th>home_player_7_pc_1</th>
      <th>home_player_7_pc_2</th>
      <th>home_player_7_pc_3</th>
      <th>home_player_7_pc_4</th>
      <th>home_player_7_pc_5</th>
      <th>home_player_8_pc_1</th>
      <th>home_player_8_pc_2</th>
      <th>home_player_8_pc_3</th>
      <th>home_player_8_pc_4</th>
      <th>home_player_8_pc_5</th>
      <th>home_player_9_pc_1</th>
      <th>home_player_9_pc_2</th>
      <th>home_player_9_pc_3</th>
      <th>home_player_9_pc_4</th>
      <th>home_player_9_pc_5</th>
      <th>home_player_10_pc_1</th>
      <th>home_player_10_pc_2</th>
      <th>home_player_10_pc_3</th>
      <th>home_player_10_pc_4</th>
      <th>home_player_10_pc_5</th>
      <th>home_player_11_pc_1</th>
      <th>home_player_11_pc_2</th>
      <th>home_player_11_pc_3</th>
      <th>home_player_11_pc_4</th>
      <th>home_player_11_pc_5</th>
      <th>away_player_1_pc_1</th>
      <th>away_player_1_pc_2</th>
      <th>away_player_1_pc_3</th>
      <th>away_player_1_pc_4</th>
      <th>away_player_1_pc_5</th>
      <th>away_player_2_pc_1</th>
      <th>away_player_2_pc_2</th>
      <th>away_player_2_pc_3</th>
      <th>away_player_2_pc_4</th>
      <th>away_player_2_pc_5</th>
      <th>away_player_3_pc_1</th>
      <th>away_player_3_pc_2</th>
      <th>away_player_3_pc_3</th>
      <th>away_player_3_pc_4</th>
      <th>away_player_3_pc_5</th>
      <th>away_player_4_pc_1</th>
      <th>away_player_4_pc_2</th>
      <th>away_player_4_pc_3</th>
      <th>away_player_4_pc_4</th>
      <th>away_player_4_pc_5</th>
      <th>away_player_5_pc_1</th>
      <th>away_player_5_pc_2</th>
      <th>away_player_5_pc_3</th>
      <th>away_player_5_pc_4</th>
      <th>away_player_5_pc_5</th>
      <th>away_player_6_pc_1</th>
      <th>away_player_6_pc_2</th>
      <th>away_player_6_pc_3</th>
      <th>away_player_6_pc_4</th>
      <th>away_player_6_pc_5</th>
      <th>away_player_7_pc_1</th>
      <th>away_player_7_pc_2</th>
      <th>away_player_7_pc_3</th>
      <th>away_player_7_pc_4</th>
      <th>away_player_7_pc_5</th>
      <th>away_player_8_pc_1</th>
      <th>away_player_8_pc_2</th>
      <th>away_player_8_pc_3</th>
      <th>away_player_8_pc_4</th>
      <th>away_player_8_pc_5</th>
      <th>away_player_9_pc_1</th>
      <th>away_player_9_pc_2</th>
      <th>away_player_9_pc_3</th>
      <th>away_player_9_pc_4</th>
      <th>away_player_9_pc_5</th>
      <th>away_player_10_pc_1</th>
      <th>away_player_10_pc_2</th>
      <th>away_player_10_pc_3</th>
      <th>away_player_10_pc_4</th>
      <th>away_player_10_pc_5</th>
      <th>away_player_11_pc_1</th>
      <th>away_player_11_pc_2</th>
      <th>away_player_11_pc_3</th>
      <th>away_player_11_pc_4</th>
      <th>away_player_11_pc_5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>493017</td>
      <td>9.172915</td>
      <td>-0.705596</td>
      <td>1.028500</td>
      <td>-0.044401</td>
      <td>1.246272</td>
      <td>3.957784</td>
      <td>1.650964</td>
      <td>-2.348632</td>
      <td>-0.837480</td>
      <td>0.223750</td>
      <td>-0.817702</td>
      <td>-0.589548</td>
      <td>0.195433</td>
      <td>-2.144582</td>
      <td>1.524434</td>
      <td>3.108730</td>
      <td>0.633708</td>
      <td>-1.772338</td>
      <td>0.807727</td>
      <td>1.684577</td>
      <td>0.615229</td>
      <td>-0.611994</td>
      <td>-0.845425</td>
      <td>0.395221</td>
      <td>3.107710</td>
      <td>-0.038702</td>
      <td>-0.551509</td>
      <td>-0.280096</td>
      <td>-0.068082</td>
      <td>2.645878</td>
      <td>1.086047</td>
      <td>-2.583583</td>
      <td>-0.596348</td>
      <td>-1.915882</td>
      <td>-0.987251</td>
      <td>-0.845848</td>
      <td>-0.053597</td>
      <td>0.746034</td>
      <td>-0.515174</td>
      <td>1.763346</td>
      <td>4.244623</td>
      <td>1.088030</td>
      <td>-2.054898</td>
      <td>-0.414998</td>
      <td>0.270225</td>
      <td>-0.559441</td>
      <td>1.233335</td>
      <td>0.426201</td>
      <td>0.609910</td>
      <td>1.364324</td>
      <td>1.472274</td>
      <td>-0.298277</td>
      <td>-1.530989</td>
      <td>0.743621</td>
      <td>-0.875547</td>
      <td>9.794795</td>
      <td>-0.549117</td>
      <td>1.941560</td>
      <td>0.281992</td>
      <td>0.521328</td>
      <td>-1.886782</td>
      <td>1.005850</td>
      <td>1.291888</td>
      <td>0.172012</td>
      <td>1.212622</td>
      <td>1.320201</td>
      <td>1.065244</td>
      <td>-0.406996</td>
      <td>-1.803778</td>
      <td>0.573483</td>
      <td>2.628391</td>
      <td>0.940615</td>
      <td>-0.609534</td>
      <td>-1.586848</td>
      <td>0.652795</td>
      <td>3.207876</td>
      <td>0.685128</td>
      <td>-1.480756</td>
      <td>-1.499414</td>
      <td>0.134771</td>
      <td>-1.360311</td>
      <td>-2.979972</td>
      <td>1.181522</td>
      <td>-0.726996</td>
      <td>1.161218</td>
      <td>-1.735000</td>
      <td>-0.323721</td>
      <td>0.977427</td>
      <td>-1.047350</td>
      <td>1.307837</td>
      <td>-0.004187</td>
      <td>1.646099</td>
      <td>0.543917</td>
      <td>0.101722</td>
      <td>0.374692</td>
      <td>-1.836650</td>
      <td>-2.551881</td>
      <td>1.212316</td>
      <td>0.139711</td>
      <td>1.155972</td>
      <td>-0.916797</td>
      <td>-1.202214</td>
      <td>0.022668</td>
      <td>-0.118531</td>
      <td>-0.332637</td>
      <td>0.628660</td>
      <td>-1.751083</td>
      <td>-0.030693</td>
      <td>0.418133</td>
      <td>-0.206630</td>
    </tr>
    <tr>
      <th>1</th>
      <td>493025</td>
      <td>6.467731</td>
      <td>-2.125163</td>
      <td>3.092089</td>
      <td>-0.930974</td>
      <td>1.172527</td>
      <td>0.390653</td>
      <td>1.341612</td>
      <td>0.109198</td>
      <td>-0.418330</td>
      <td>0.921304</td>
      <td>2.673401</td>
      <td>1.688787</td>
      <td>-0.346764</td>
      <td>0.032250</td>
      <td>-0.148238</td>
      <td>0.544724</td>
      <td>0.856618</td>
      <td>-0.234054</td>
      <td>-0.185530</td>
      <td>1.496783</td>
      <td>0.349558</td>
      <td>-0.322471</td>
      <td>0.311433</td>
      <td>-0.720916</td>
      <td>0.765089</td>
      <td>-2.997770</td>
      <td>-1.279240</td>
      <td>1.492689</td>
      <td>-0.174247</td>
      <td>1.728035</td>
      <td>-1.262416</td>
      <td>0.290702</td>
      <td>1.097804</td>
      <td>0.377514</td>
      <td>1.681666</td>
      <td>-1.035827</td>
      <td>-0.034337</td>
      <td>1.133088</td>
      <td>0.899750</td>
      <td>1.451945</td>
      <td>-1.970162</td>
      <td>-1.958911</td>
      <td>1.072887</td>
      <td>0.806278</td>
      <td>2.735079</td>
      <td>-1.206227</td>
      <td>-2.567254</td>
      <td>0.401355</td>
      <td>-0.240084</td>
      <td>1.552955</td>
      <td>-0.417405</td>
      <td>-0.845298</td>
      <td>0.077456</td>
      <td>-1.026087</td>
      <td>-0.249720</td>
      <td>6.746068</td>
      <td>-1.225452</td>
      <td>5.441467</td>
      <td>-1.741143</td>
      <td>0.153029</td>
      <td>-0.720625</td>
      <td>1.362837</td>
      <td>0.950063</td>
      <td>-0.430052</td>
      <td>1.920381</td>
      <td>1.321520</td>
      <td>2.234319</td>
      <td>0.546943</td>
      <td>0.392576</td>
      <td>1.081937</td>
      <td>-1.157135</td>
      <td>1.181325</td>
      <td>0.901247</td>
      <td>0.722505</td>
      <td>0.967595</td>
      <td>-1.573349</td>
      <td>0.366277</td>
      <td>1.085719</td>
      <td>-0.362088</td>
      <td>0.794429</td>
      <td>-2.362155</td>
      <td>0.960996</td>
      <td>2.341796</td>
      <td>0.480765</td>
      <td>1.235871</td>
      <td>-2.036662</td>
      <td>1.423269</td>
      <td>1.975662</td>
      <td>0.456836</td>
      <td>0.564672</td>
      <td>-1.002934</td>
      <td>-2.335553</td>
      <td>0.470491</td>
      <td>-0.111478</td>
      <td>0.585989</td>
      <td>-1.407944</td>
      <td>-2.205414</td>
      <td>1.069296</td>
      <td>0.053596</td>
      <td>0.809813</td>
      <td>-2.259696</td>
      <td>-2.778135</td>
      <td>1.816538</td>
      <td>1.407815</td>
      <td>0.022775</td>
      <td>0.169010</td>
      <td>-2.319129</td>
      <td>0.361658</td>
      <td>0.935315</td>
      <td>-1.877390</td>
    </tr>
    <tr>
      <th>2</th>
      <td>493027</td>
      <td>7.587977</td>
      <td>-0.669761</td>
      <td>3.351410</td>
      <td>-1.725204</td>
      <td>0.971832</td>
      <td>-0.659142</td>
      <td>2.447278</td>
      <td>1.853202</td>
      <td>-0.962117</td>
      <td>0.277773</td>
      <td>0.782575</td>
      <td>2.059493</td>
      <td>1.311728</td>
      <td>-0.983126</td>
      <td>0.652947</td>
      <td>0.750721</td>
      <td>3.078327</td>
      <td>1.228950</td>
      <td>0.540478</td>
      <td>0.034199</td>
      <td>0.361849</td>
      <td>2.339354</td>
      <td>1.689313</td>
      <td>0.713260</td>
      <td>0.455514</td>
      <td>-3.759299</td>
      <td>1.204148</td>
      <td>3.191002</td>
      <td>-0.784951</td>
      <td>0.913294</td>
      <td>-3.018176</td>
      <td>0.545416</td>
      <td>2.535436</td>
      <td>-0.218828</td>
      <td>2.658318</td>
      <td>-2.589758</td>
      <td>0.570906</td>
      <td>1.654008</td>
      <td>0.345163</td>
      <td>0.580780</td>
      <td>-3.859427</td>
      <td>-1.870653</td>
      <td>2.659663</td>
      <td>-0.725774</td>
      <td>2.171793</td>
      <td>-0.199689</td>
      <td>-2.415793</td>
      <td>-0.317491</td>
      <td>0.067180</td>
      <td>0.943378</td>
      <td>-1.056848</td>
      <td>-1.205950</td>
      <td>1.067483</td>
      <td>1.246078</td>
      <td>-0.070047</td>
      <td>8.942737</td>
      <td>-2.146976</td>
      <td>1.394474</td>
      <td>-1.573403</td>
      <td>-0.305385</td>
      <td>0.326027</td>
      <td>1.666843</td>
      <td>0.694338</td>
      <td>0.105792</td>
      <td>1.385551</td>
      <td>1.716745</td>
      <td>1.133649</td>
      <td>-0.670094</td>
      <td>-1.374712</td>
      <td>0.468374</td>
      <td>1.822806</td>
      <td>1.126330</td>
      <td>-0.789073</td>
      <td>-1.478142</td>
      <td>0.878564</td>
      <td>5.021780</td>
      <td>0.645976</td>
      <td>-1.954515</td>
      <td>-1.642732</td>
      <td>0.230055</td>
      <td>0.882744</td>
      <td>1.703690</td>
      <td>0.053693</td>
      <td>0.563981</td>
      <td>0.978446</td>
      <td>-0.780143</td>
      <td>-0.700812</td>
      <td>0.612057</td>
      <td>1.416142</td>
      <td>2.059364</td>
      <td>-0.691788</td>
      <td>-2.016431</td>
      <td>0.356132</td>
      <td>-1.164456</td>
      <td>2.251789</td>
      <td>1.464444</td>
      <td>0.379332</td>
      <td>-0.902796</td>
      <td>-0.837762</td>
      <td>0.211743</td>
      <td>1.923084</td>
      <td>-2.893726</td>
      <td>-2.042800</td>
      <td>-1.018973</td>
      <td>-1.292926</td>
      <td>0.416905</td>
      <td>-2.210474</td>
      <td>-0.336256</td>
      <td>0.054563</td>
      <td>2.588626</td>
    </tr>
    <tr>
      <th>3</th>
      <td>493034</td>
      <td>9.172915</td>
      <td>-0.705596</td>
      <td>1.028500</td>
      <td>-0.044401</td>
      <td>1.246272</td>
      <td>3.957784</td>
      <td>1.650964</td>
      <td>-2.348632</td>
      <td>-0.837480</td>
      <td>0.223750</td>
      <td>-0.817702</td>
      <td>-0.589548</td>
      <td>0.195433</td>
      <td>-2.144582</td>
      <td>1.524434</td>
      <td>-0.559441</td>
      <td>1.233335</td>
      <td>0.426201</td>
      <td>0.609910</td>
      <td>1.364324</td>
      <td>-0.845848</td>
      <td>-0.053597</td>
      <td>0.746034</td>
      <td>-0.515174</td>
      <td>1.763346</td>
      <td>0.615229</td>
      <td>-0.611994</td>
      <td>-0.845425</td>
      <td>0.395221</td>
      <td>3.107710</td>
      <td>3.108730</td>
      <td>0.633708</td>
      <td>-1.772338</td>
      <td>0.807727</td>
      <td>1.684577</td>
      <td>1.086047</td>
      <td>-2.583583</td>
      <td>-0.596348</td>
      <td>-1.915882</td>
      <td>-0.987251</td>
      <td>4.244623</td>
      <td>1.088030</td>
      <td>-2.054898</td>
      <td>-0.414998</td>
      <td>0.270225</td>
      <td>-0.105750</td>
      <td>0.211866</td>
      <td>0.619067</td>
      <td>0.766076</td>
      <td>-0.979514</td>
      <td>1.472274</td>
      <td>-0.298277</td>
      <td>-1.530989</td>
      <td>0.743621</td>
      <td>-0.875547</td>
      <td>7.587977</td>
      <td>-0.669761</td>
      <td>3.351410</td>
      <td>-1.725204</td>
      <td>0.971832</td>
      <td>-0.659142</td>
      <td>2.447278</td>
      <td>1.853202</td>
      <td>-0.962117</td>
      <td>0.277773</td>
      <td>0.361849</td>
      <td>2.339354</td>
      <td>1.689313</td>
      <td>0.713260</td>
      <td>0.455514</td>
      <td>1.052194</td>
      <td>2.080899</td>
      <td>0.370792</td>
      <td>-0.782729</td>
      <td>0.394531</td>
      <td>2.077104</td>
      <td>1.903504</td>
      <td>0.684877</td>
      <td>1.471026</td>
      <td>-0.492695</td>
      <td>-3.759299</td>
      <td>1.204148</td>
      <td>3.191002</td>
      <td>-0.784951</td>
      <td>0.913294</td>
      <td>-0.631336</td>
      <td>-1.917288</td>
      <td>0.404582</td>
      <td>-1.604514</td>
      <td>-0.334234</td>
      <td>-3.859427</td>
      <td>-1.870653</td>
      <td>2.659663</td>
      <td>-0.725774</td>
      <td>2.171793</td>
      <td>-3.018176</td>
      <td>0.545416</td>
      <td>2.535436</td>
      <td>-0.218828</td>
      <td>2.658318</td>
      <td>-2.589758</td>
      <td>0.570906</td>
      <td>1.654008</td>
      <td>0.345163</td>
      <td>0.580780</td>
      <td>-1.056848</td>
      <td>-1.205950</td>
      <td>1.067483</td>
      <td>1.246078</td>
      <td>-0.070047</td>
    </tr>
    <tr>
      <th>4</th>
      <td>493040</td>
      <td>8.942737</td>
      <td>-2.146976</td>
      <td>1.394474</td>
      <td>-1.573403</td>
      <td>-0.305385</td>
      <td>0.326027</td>
      <td>1.666843</td>
      <td>0.694338</td>
      <td>0.105792</td>
      <td>1.385551</td>
      <td>1.831429</td>
      <td>1.436093</td>
      <td>-0.753915</td>
      <td>-1.703966</td>
      <td>1.116009</td>
      <td>1.716745</td>
      <td>1.133649</td>
      <td>-0.670094</td>
      <td>-1.374712</td>
      <td>0.468374</td>
      <td>1.822806</td>
      <td>1.126330</td>
      <td>-0.789073</td>
      <td>-1.478142</td>
      <td>0.878564</td>
      <td>0.882744</td>
      <td>1.703690</td>
      <td>0.053693</td>
      <td>0.563981</td>
      <td>0.978446</td>
      <td>-0.780143</td>
      <td>-0.700812</td>
      <td>0.612057</td>
      <td>1.416142</td>
      <td>2.059364</td>
      <td>-0.691788</td>
      <td>-2.016431</td>
      <td>0.356132</td>
      <td>-1.164456</td>
      <td>2.251789</td>
      <td>0.416905</td>
      <td>-2.210474</td>
      <td>-0.336256</td>
      <td>0.054563</td>
      <td>2.588626</td>
      <td>1.923084</td>
      <td>-2.893726</td>
      <td>-2.042800</td>
      <td>-1.018973</td>
      <td>-1.292926</td>
      <td>1.464444</td>
      <td>0.379332</td>
      <td>-0.902796</td>
      <td>-0.837762</td>
      <td>0.211743</td>
      <td>9.554376</td>
      <td>-0.788436</td>
      <td>2.277353</td>
      <td>0.709577</td>
      <td>0.731361</td>
      <td>1.970444</td>
      <td>1.864556</td>
      <td>-0.597320</td>
      <td>0.168243</td>
      <td>0.246152</td>
      <td>4.470705</td>
      <td>2.449109</td>
      <td>-1.396639</td>
      <td>-0.315235</td>
      <td>0.008914</td>
      <td>1.829497</td>
      <td>1.079852</td>
      <td>-2.363541</td>
      <td>-0.545278</td>
      <td>0.775451</td>
      <td>4.019384</td>
      <td>0.341251</td>
      <td>-2.730811</td>
      <td>-1.093104</td>
      <td>0.247451</td>
      <td>0.682845</td>
      <td>0.218515</td>
      <td>-0.581395</td>
      <td>0.951872</td>
      <td>2.794600</td>
      <td>-0.793495</td>
      <td>-0.740710</td>
      <td>0.492791</td>
      <td>0.151706</td>
      <td>2.489086</td>
      <td>1.933672</td>
      <td>0.891587</td>
      <td>-1.109525</td>
      <td>-0.792216</td>
      <td>-0.402166</td>
      <td>-0.203211</td>
      <td>-1.625096</td>
      <td>-0.009942</td>
      <td>0.220891</td>
      <td>1.091029</td>
      <td>0.344323</td>
      <td>-3.281820</td>
      <td>-1.047589</td>
      <td>-0.870665</td>
      <td>0.278254</td>
      <td>0.817798</td>
      <td>-2.420838</td>
      <td>-0.361229</td>
      <td>0.689072</td>
      <td>-0.850103</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21369</th>
      <td>1992089</td>
      <td>10.658392</td>
      <td>-1.977648</td>
      <td>0.867377</td>
      <td>0.480266</td>
      <td>1.074043</td>
      <td>2.309500</td>
      <td>0.931667</td>
      <td>-3.860209</td>
      <td>0.540601</td>
      <td>-0.235396</td>
      <td>4.829365</td>
      <td>3.813902</td>
      <td>-2.190143</td>
      <td>2.896975</td>
      <td>0.303158</td>
      <td>4.363347</td>
      <td>3.346856</td>
      <td>-2.511394</td>
      <td>1.256390</td>
      <td>-1.264653</td>
      <td>0.693648</td>
      <td>2.017825</td>
      <td>-1.753765</td>
      <td>-2.152817</td>
      <td>-0.662817</td>
      <td>2.162406</td>
      <td>-2.749882</td>
      <td>-4.593596</td>
      <td>0.434768</td>
      <td>0.841622</td>
      <td>-0.817444</td>
      <td>1.999270</td>
      <td>-0.449227</td>
      <td>-0.166485</td>
      <td>-0.336412</td>
      <td>1.345606</td>
      <td>0.069802</td>
      <td>-3.170566</td>
      <td>-0.790618</td>
      <td>1.344050</td>
      <td>-1.052756</td>
      <td>0.131148</td>
      <td>-1.406108</td>
      <td>-0.920376</td>
      <td>1.149814</td>
      <td>-0.756354</td>
      <td>-0.555587</td>
      <td>-0.498005</td>
      <td>0.934758</td>
      <td>-2.606863</td>
      <td>-2.571317</td>
      <td>-2.788252</td>
      <td>-0.783057</td>
      <td>-0.228549</td>
      <td>0.825315</td>
      <td>11.297455</td>
      <td>-1.943311</td>
      <td>-0.622608</td>
      <td>1.229927</td>
      <td>2.987196</td>
      <td>0.715893</td>
      <td>1.452546</td>
      <td>-2.111059</td>
      <td>-0.524585</td>
      <td>0.158115</td>
      <td>5.742015</td>
      <td>3.143138</td>
      <td>-3.280495</td>
      <td>0.901933</td>
      <td>-1.055971</td>
      <td>3.559549</td>
      <td>2.023672</td>
      <td>-2.954817</td>
      <td>1.214646</td>
      <td>0.395441</td>
      <td>-0.652392</td>
      <td>0.617508</td>
      <td>-2.119288</td>
      <td>0.420918</td>
      <td>-0.312378</td>
      <td>-1.179215</td>
      <td>0.990786</td>
      <td>-0.758331</td>
      <td>0.280326</td>
      <td>-1.019536</td>
      <td>-0.983237</td>
      <td>1.033960</td>
      <td>-0.714609</td>
      <td>-0.027433</td>
      <td>0.645499</td>
      <td>-0.468185</td>
      <td>-2.492838</td>
      <td>-2.135542</td>
      <td>0.672037</td>
      <td>1.175961</td>
      <td>0.089223</td>
      <td>-1.409898</td>
      <td>-2.184536</td>
      <td>0.860498</td>
      <td>2.273182</td>
      <td>-1.604118</td>
      <td>-1.071515</td>
      <td>-1.719817</td>
      <td>-0.597994</td>
      <td>0.268359</td>
      <td>-2.027482</td>
      <td>-0.929774</td>
      <td>-0.429955</td>
      <td>-0.408179</td>
      <td>-0.159691</td>
    </tr>
    <tr>
      <th>21370</th>
      <td>1992091</td>
      <td>12.241704</td>
      <td>-2.064268</td>
      <td>0.575912</td>
      <td>0.027214</td>
      <td>0.566339</td>
      <td>2.941632</td>
      <td>1.263739</td>
      <td>-2.564271</td>
      <td>-0.317355</td>
      <td>0.251567</td>
      <td>-0.338978</td>
      <td>1.001774</td>
      <td>-1.054876</td>
      <td>0.023669</td>
      <td>0.503527</td>
      <td>3.322061</td>
      <td>2.191727</td>
      <td>-1.431455</td>
      <td>-0.935647</td>
      <td>-2.106780</td>
      <td>0.805775</td>
      <td>2.313243</td>
      <td>-1.001739</td>
      <td>-0.734564</td>
      <td>-1.002397</td>
      <td>0.167600</td>
      <td>0.748910</td>
      <td>-2.441020</td>
      <td>-0.128875</td>
      <td>1.354357</td>
      <td>-0.992210</td>
      <td>1.486864</td>
      <td>-0.837892</td>
      <td>-0.283414</td>
      <td>0.885329</td>
      <td>-0.144093</td>
      <td>-1.113188</td>
      <td>-1.698684</td>
      <td>0.131062</td>
      <td>0.388273</td>
      <td>-1.074581</td>
      <td>-2.141164</td>
      <td>-1.372831</td>
      <td>0.593159</td>
      <td>-0.060973</td>
      <td>-1.374814</td>
      <td>-2.597658</td>
      <td>-1.353337</td>
      <td>-0.079045</td>
      <td>0.449154</td>
      <td>1.613120</td>
      <td>-2.543332</td>
      <td>-2.596794</td>
      <td>1.483082</td>
      <td>0.105411</td>
      <td>12.290704</td>
      <td>-2.430347</td>
      <td>-1.144252</td>
      <td>-0.197618</td>
      <td>0.806754</td>
      <td>4.561174</td>
      <td>1.116819</td>
      <td>-3.853639</td>
      <td>-1.449020</td>
      <td>-0.008049</td>
      <td>0.859240</td>
      <td>1.593152</td>
      <td>-1.523836</td>
      <td>0.182434</td>
      <td>0.923206</td>
      <td>3.366277</td>
      <td>2.096648</td>
      <td>-2.560049</td>
      <td>1.302320</td>
      <td>0.621418</td>
      <td>-0.179065</td>
      <td>1.542439</td>
      <td>-0.883813</td>
      <td>-1.534520</td>
      <td>-0.929437</td>
      <td>-1.274091</td>
      <td>1.044816</td>
      <td>-0.632610</td>
      <td>0.214867</td>
      <td>-1.155989</td>
      <td>-1.165921</td>
      <td>1.062657</td>
      <td>-0.462190</td>
      <td>-0.128853</td>
      <td>0.815702</td>
      <td>-0.551649</td>
      <td>-3.139936</td>
      <td>-1.871850</td>
      <td>0.919162</td>
      <td>1.101761</td>
      <td>-0.895229</td>
      <td>-1.357762</td>
      <td>-1.203311</td>
      <td>0.502165</td>
      <td>1.217481</td>
      <td>0.817539</td>
      <td>-1.879420</td>
      <td>-1.866788</td>
      <td>1.257348</td>
      <td>-2.040793</td>
      <td>-2.027482</td>
      <td>-0.929774</td>
      <td>-0.429955</td>
      <td>-0.408179</td>
      <td>-0.159691</td>
    </tr>
    <tr>
      <th>21371</th>
      <td>1992092</td>
      <td>12.064639</td>
      <td>-2.316174</td>
      <td>0.433132</td>
      <td>0.848287</td>
      <td>2.231699</td>
      <td>0.041330</td>
      <td>1.067682</td>
      <td>-1.528655</td>
      <td>1.481193</td>
      <td>0.463667</td>
      <td>0.484107</td>
      <td>2.132478</td>
      <td>-2.712916</td>
      <td>0.415998</td>
      <td>-0.482643</td>
      <td>2.368090</td>
      <td>1.818320</td>
      <td>-1.835697</td>
      <td>2.213761</td>
      <td>1.021893</td>
      <td>2.542915</td>
      <td>2.152431</td>
      <td>-2.292237</td>
      <td>-0.564741</td>
      <td>0.029556</td>
      <td>-0.661431</td>
      <td>1.259634</td>
      <td>-1.538893</td>
      <td>0.327645</td>
      <td>1.036215</td>
      <td>-2.276135</td>
      <td>-1.075133</td>
      <td>-1.057017</td>
      <td>0.562307</td>
      <td>1.955697</td>
      <td>1.429669</td>
      <td>1.815169</td>
      <td>-2.713671</td>
      <td>-1.202667</td>
      <td>-0.206876</td>
      <td>-2.066585</td>
      <td>-1.486135</td>
      <td>-2.249610</td>
      <td>0.528683</td>
      <td>1.248011</td>
      <td>2.305110</td>
      <td>0.196755</td>
      <td>-3.015813</td>
      <td>0.884716</td>
      <td>1.782990</td>
      <td>0.202502</td>
      <td>0.363303</td>
      <td>-2.203897</td>
      <td>0.890204</td>
      <td>1.972601</td>
      <td>11.605200</td>
      <td>-2.180668</td>
      <td>0.633318</td>
      <td>0.505193</td>
      <td>2.121379</td>
      <td>0.936419</td>
      <td>1.221556</td>
      <td>-2.522024</td>
      <td>-0.246410</td>
      <td>0.123592</td>
      <td>0.472920</td>
      <td>1.911681</td>
      <td>-1.404507</td>
      <td>-1.552859</td>
      <td>0.102178</td>
      <td>2.614211</td>
      <td>3.470441</td>
      <td>-0.910743</td>
      <td>4.107990</td>
      <td>0.561911</td>
      <td>-0.386817</td>
      <td>2.148362</td>
      <td>-0.789333</td>
      <td>0.490890</td>
      <td>0.348217</td>
      <td>1.412310</td>
      <td>-0.776693</td>
      <td>-3.695553</td>
      <td>-2.537028</td>
      <td>0.654647</td>
      <td>0.038726</td>
      <td>0.194863</td>
      <td>-1.450742</td>
      <td>-1.480179</td>
      <td>-0.329070</td>
      <td>-1.248945</td>
      <td>0.135936</td>
      <td>-0.373578</td>
      <td>-0.008843</td>
      <td>1.145546</td>
      <td>-1.268382</td>
      <td>-2.736194</td>
      <td>-2.134065</td>
      <td>-2.336878</td>
      <td>0.312531</td>
      <td>-1.267814</td>
      <td>-0.952598</td>
      <td>-0.567959</td>
      <td>1.417181</td>
      <td>-1.031334</td>
      <td>-2.777047</td>
      <td>-2.958610</td>
      <td>-1.015094</td>
      <td>-0.426489</td>
      <td>1.111898</td>
    </tr>
    <tr>
      <th>21372</th>
      <td>1992093</td>
      <td>12.055222</td>
      <td>-2.425069</td>
      <td>1.339212</td>
      <td>0.274265</td>
      <td>0.840987</td>
      <td>0.807082</td>
      <td>0.384775</td>
      <td>-3.089207</td>
      <td>-1.255036</td>
      <td>0.706752</td>
      <td>3.316945</td>
      <td>2.584242</td>
      <td>-1.555439</td>
      <td>-0.624218</td>
      <td>-1.494029</td>
      <td>0.752059</td>
      <td>2.634155</td>
      <td>0.029098</td>
      <td>-2.048228</td>
      <td>-2.345172</td>
      <td>-0.477442</td>
      <td>0.588966</td>
      <td>-1.810286</td>
      <td>-0.671132</td>
      <td>0.670969</td>
      <td>-4.479330</td>
      <td>0.957108</td>
      <td>1.567778</td>
      <td>1.821481</td>
      <td>1.887503</td>
      <td>-0.304292</td>
      <td>2.229022</td>
      <td>-0.374285</td>
      <td>-0.629550</td>
      <td>-0.550464</td>
      <td>-2.488337</td>
      <td>-2.492236</td>
      <td>0.004280</td>
      <td>-0.328167</td>
      <td>-0.137174</td>
      <td>-1.303862</td>
      <td>-3.461748</td>
      <td>-0.804760</td>
      <td>-0.413108</td>
      <td>-1.193188</td>
      <td>-3.587590</td>
      <td>-2.419330</td>
      <td>0.831607</td>
      <td>2.357133</td>
      <td>0.281695</td>
      <td>-2.476574</td>
      <td>-2.795499</td>
      <td>-0.080093</td>
      <td>0.062647</td>
      <td>-2.011499</td>
      <td>12.360092</td>
      <td>-1.868190</td>
      <td>1.990823</td>
      <td>0.546306</td>
      <td>0.372803</td>
      <td>-1.329084</td>
      <td>1.395726</td>
      <td>-0.722913</td>
      <td>-0.893829</td>
      <td>0.215497</td>
      <td>1.165437</td>
      <td>3.021942</td>
      <td>-0.188859</td>
      <td>2.311939</td>
      <td>0.403286</td>
      <td>-4.008986</td>
      <td>1.662399</td>
      <td>0.332054</td>
      <td>0.291516</td>
      <td>1.172819</td>
      <td>-1.397060</td>
      <td>1.400592</td>
      <td>-0.140128</td>
      <td>-0.156016</td>
      <td>-0.683065</td>
      <td>-1.079926</td>
      <td>0.426619</td>
      <td>-0.576034</td>
      <td>-2.142184</td>
      <td>-0.515036</td>
      <td>-0.909491</td>
      <td>1.934916</td>
      <td>0.160027</td>
      <td>0.916388</td>
      <td>1.269362</td>
      <td>-1.061561</td>
      <td>-2.717686</td>
      <td>-0.665092</td>
      <td>-0.671323</td>
      <td>-2.761000</td>
      <td>-1.823349</td>
      <td>-1.744156</td>
      <td>-0.979761</td>
      <td>0.332470</td>
      <td>0.702492</td>
      <td>-1.032879</td>
      <td>-1.066695</td>
      <td>-0.612696</td>
      <td>-0.450766</td>
      <td>0.290344</td>
      <td>-1.642076</td>
      <td>-3.316316</td>
      <td>0.011961</td>
      <td>0.375835</td>
      <td>-3.465042</td>
    </tr>
    <tr>
      <th>21373</th>
      <td>1992095</td>
      <td>11.109830</td>
      <td>-2.853322</td>
      <td>3.703596</td>
      <td>-0.584121</td>
      <td>-0.402950</td>
      <td>-0.371390</td>
      <td>1.595755</td>
      <td>-1.118035</td>
      <td>-1.088917</td>
      <td>-0.072962</td>
      <td>0.782687</td>
      <td>3.074394</td>
      <td>-0.351447</td>
      <td>0.339711</td>
      <td>-0.876789</td>
      <td>0.954087</td>
      <td>3.884860</td>
      <td>0.323121</td>
      <td>-0.869362</td>
      <td>-1.514651</td>
      <td>-1.424525</td>
      <td>1.026468</td>
      <td>-0.666682</td>
      <td>-0.521699</td>
      <td>1.419345</td>
      <td>-2.778054</td>
      <td>-3.370352</td>
      <td>-0.446712</td>
      <td>-0.978029</td>
      <td>-0.758080</td>
      <td>2.408722</td>
      <td>1.658858</td>
      <td>-2.251337</td>
      <td>-0.820091</td>
      <td>-0.630519</td>
      <td>-2.159654</td>
      <td>1.814418</td>
      <td>0.256719</td>
      <td>0.567236</td>
      <td>-0.314540</td>
      <td>-2.998560</td>
      <td>-3.922779</td>
      <td>0.105072</td>
      <td>0.225998</td>
      <td>1.222075</td>
      <td>-1.617306</td>
      <td>-2.339904</td>
      <td>-0.992463</td>
      <td>-1.548240</td>
      <td>0.519653</td>
      <td>-2.910805</td>
      <td>-2.167197</td>
      <td>0.101099</td>
      <td>1.144445</td>
      <td>-0.165881</td>
      <td>12.307758</td>
      <td>-1.719545</td>
      <td>4.261962</td>
      <td>0.728169</td>
      <td>1.500838</td>
      <td>-1.795498</td>
      <td>2.597198</td>
      <td>0.399761</td>
      <td>-0.004946</td>
      <td>-0.912142</td>
      <td>1.097353</td>
      <td>2.822507</td>
      <td>-0.720652</td>
      <td>-1.295103</td>
      <td>-1.490739</td>
      <td>-1.267830</td>
      <td>3.175089</td>
      <td>1.368422</td>
      <td>-0.396539</td>
      <td>-2.110602</td>
      <td>0.679151</td>
      <td>1.514007</td>
      <td>-0.744474</td>
      <td>-2.598616</td>
      <td>-1.680172</td>
      <td>-2.472498</td>
      <td>1.701903</td>
      <td>0.506631</td>
      <td>-1.382100</td>
      <td>-0.412576</td>
      <td>-3.875220</td>
      <td>1.593144</td>
      <td>1.643325</td>
      <td>2.150146</td>
      <td>2.170000</td>
      <td>-1.395402</td>
      <td>0.464636</td>
      <td>-0.435683</td>
      <td>-0.975001</td>
      <td>-1.386601</td>
      <td>-3.586664</td>
      <td>-2.865959</td>
      <td>0.395006</td>
      <td>1.476579</td>
      <td>2.034092</td>
      <td>-4.892234</td>
      <td>-0.601987</td>
      <td>1.354383</td>
      <td>0.830095</td>
      <td>-0.426868</td>
      <td>-3.654878</td>
      <td>-2.094599</td>
      <td>1.339425</td>
      <td>0.285083</td>
      <td>-2.245146</td>
    </tr>
  </tbody>
</table>
<p>21374 rows × 111 columns</p>
</div>



- Save the table.


```python
df_match_player_attr_pcs.to_csv("../data/df_match_player_attr_pcs.csv", index = False)
```


```python

```
